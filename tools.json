{
  "commands": [
    {
      "id": 1,
      "command": "vmpt=\"2052\" hypt=\"50004\"  uuid=\"57628066-f4a3-47cf-85dc-560d92d4b856\" cdnym=\"chf5762.cloudns.org\" ippz=\"4\" bash <(curl -Ls https://raw.githubusercontent.com/yonggekkk/argosbx/main/argosbx.sh) rep",
      "added_time": "2025-11-16T12:39:47Z"
    },
    {
      "id": 2,
      "command": "docker run -d -p 8181:8181 --name fuclaude-app pengzhile/fuclaude:latest",
      "added_time": "2025-11-16T12:40:52Z"
    }
  ],
  "scripts": [
    {
      "id": 5,
      "name": "API éƒ¨ç½²è„šæœ¬",
      "content": "#!/bin/bash\n\n# =========================================================\n# æœ€ç»ˆæ™ºèƒ½ç‰ˆï¼šç›®å½•æŒ‡å®šäº¤äº’å¼éƒ¨ç½²è„šæœ¬\n# åŠŸèƒ½: è¯¢é—® API ç›®å½•ï¼Œäº¤äº’å¼è·å–ç«¯å£å’Œæ–‡ä»¶åï¼Œè‡ªåŠ¨å®Œæˆéƒ¨ç½²ã€‚\n# =========================================================\n\n# 1. äº¤äº’å¼è·å–é¡¹ç›®ç›®å½•\necho \"--- Flask/Gunicorn API äº¤äº’å¼éƒ¨ç½² ---\"\nread -p \"è¯·è¾“å…¥æ‚¨çš„ API é¡¹ç›®æ ¹ç›®å½• (ä¾‹å¦‚: /root/music æˆ– /root/weather_api): \" PROJECT_DIR_INPUT\n\n# æ£€æŸ¥ç›®å½•æ˜¯å¦ä¸ºç©º\nif [ -z \"$PROJECT_DIR_INPUT\" ]; then\n    echo \"ğŸš¨ é”™è¯¯: é¡¹ç›®ç›®å½•ä¸èƒ½ä¸ºç©ºï¼\"\n    exit 1\nfi\n\nPROJECT_DIR=$(echo \"$PROJECT_DIR_INPUT\" | sed 's:/*$::') # ç§»é™¤æœ«å°¾æ–œæ \nmkdir -p $PROJECT_DIR\n\n# 2. è‡ªåŠ¨å®šä¹‰å’Œæ´¾ç”Ÿæ ¸å¿ƒå˜é‡\n# ä»è·¯å¾„ä¸­æå–ç›®å½•åä½œä¸ºåŸºç¡€æœåŠ¡å (ä¾‹å¦‚ /root/music -> music)\nBASE_NAME=$(basename \"$PROJECT_DIR\" | tr '[:upper:]' '[:lower:]' | tr -cd '[:alnum:]')\nSERVICE_NAME=\"${BASE_NAME}api\"\n\nVENV_PATH=\"$PROJECT_DIR/venv\"\nGUNICORN_PATH=\"$VENV_PATH/bin/gunicorn\"\nSERVICE_FILE=\"/etc/systemd/system/$SERVICE_NAME.service\"\nWORKERS=4\n\n# 3. äº¤äº’å¼è·å–ç«¯å£å’Œ API æ–‡ä»¶å\necho \"--- é…ç½®ä¿¡æ¯ ---\"\necho \"æœåŠ¡åç§°å°†æ˜¯: $SERVICE_NAME\"\necho \"----------------\"\n\n# è·å–ç«¯å£\nread -p \"è¯·è¾“å…¥æœåŠ¡ç«¯å£å· (é»˜è®¤ 9200): \" PORT_INPUT\nPORT=${PORT_INPUT:-9200}\n\n# è·å– API æ–‡ä»¶å\nread -p \"è¯·è¾“å…¥æ‚¨çš„ API æ–‡ä»¶å (é»˜è®¤ api_runner.py): \" API_FILE_INPUT\nAPI_FILE=${API_FILE_INPUT:-api_runner.py}\nFLASK_APP_MODULE=$(echo \"$API_FILE\" | sed 's/\\.py$//')\n\n\necho \"--- é…ç½®ç¡®è®¤ ---\"\necho \"é¡¹ç›®ç›®å½•: $PROJECT_DIR\"\necho \"æœåŠ¡ç«¯å£: $PORT\"\necho \"API æ–‡ä»¶: $API_FILE\"\necho \"----------------\"\n\n\n# 4. æ£€æŸ¥è™šæ‹Ÿç¯å¢ƒå’Œä¾èµ–\necho \"--- 1. æ£€æŸ¥è™šæ‹Ÿç¯å¢ƒå’Œä¾èµ– (è·³è¿‡å·²å®‰è£…çš„æ­¥éª¤) ---\"\n# ... (æ­¤å¤„æ˜¯ç¯å¢ƒæ£€æŸ¥å’Œå®‰è£…ä¾èµ–çš„é€»è¾‘ï¼Œä¸ä¸Šä¸€ä¸ªè„šæœ¬ç›¸åŒ) ...\nif [ ! -d \"$VENV_PATH\" ]; then\n    echo \"    - è™šæ‹Ÿç¯å¢ƒä¸å­˜åœ¨ï¼Œæ­£åœ¨åˆ›å»ºå¹¶å®‰è£…ä¾èµ–...\"\n    # æ£€æŸ¥å¹¶å®‰è£… venv ä¾èµ–\n    if command -v apt &> /dev/null; then\n        sudo apt update && sudo apt install -y python3-venv\n    elif command -v yum &> /dev/null; then\n        sudo yum install -y python3-venv\n    fi\n    \n    python3 -m venv $VENV_PATH\n    source $VENV_PATH/bin/activate\n    pip install Flask gunicorn requests\n    deactivate\nelse\n    echo \"    - è™šæ‹Ÿç¯å¢ƒå·²å­˜åœ¨ï¼Œè·³è¿‡åˆ›å»ºæ­¥éª¤ã€‚\"\nfi\n\n\n# 5. ç”Ÿæˆ/æ£€æŸ¥ API ä»£ç æ–‡ä»¶\necho \"--- 2. æ£€æŸ¥ API ä»£ç æ–‡ä»¶ ---\"\nif [ ! -f \"$PROJECT_DIR/$API_FILE\" ]; then\n    echo \"    - $API_FILE ä¸å­˜åœ¨ï¼Œæ­£åœ¨ $PROJECT_DIR ç›®å½•ç”Ÿæˆæ¨¡æ¿æ–‡ä»¶ã€‚è¯·æ‰‹åŠ¨æ›¿æ¢ä¸ºå®é™…ä»£ç ï¼\"\n    cat > \"$PROJECT_DIR/$API_FILE\" <<EOF\nimport requests\nfrom flask import Flask, jsonify\n\n# ================= æ ¸å¿ƒé…ç½® =================\nPORT = $PORT\n# ============================================\n\napp = Flask(__name__)\n\n@app.route('/', methods=['GET'])\ndef index():\n    return jsonify({\"code\": 200, \"message\": \"æ–°çš„APIæœåŠ¡æ­£åœ¨è¿è¡Œ!\", \"port\": PORT})\n\n# è¯·å°†æ‚¨çš„å®é™…ä»£ç ç²˜è´´åˆ°è¿™é‡Œ\nEOF\nelse\n    echo \"    - $API_FILE å·²å­˜åœ¨ï¼Œè·³è¿‡ä»£ç ç”Ÿæˆã€‚\"\nfi\n\n\n# 6. åˆ›å»º systemd æœåŠ¡æ–‡ä»¶ (æ ¸å¿ƒï¼šæ‰€æœ‰è·¯å¾„å‡ä½¿ç”¨ $PROJECT_DIR)\necho \"--- 3. åˆ›å»º systemd æœåŠ¡æ–‡ä»¶ ---\"\nif sudo [ -f \"$GUNICORN_PATH\" ]; then\n    cat > $SERVICE_FILE <<EOF\n[Unit]\nDescription=Flask API Service for $BASE_NAME\nAfter=network.target\n\n[Service]\nUser=root\nWorkingDirectory=$PROJECT_DIR/\n# æ ¸å¿ƒå‘½ä»¤ï¼šä½¿ç”¨åŠ¨æ€è·¯å¾„ã€ç«¯å£å’Œæ¨¡å—å\nExecStart=$GUNICORN_PATH -w $WORKERS -b 0.0.0.0:$PORT $FLASK_APP_MODULE:app\nRestart=always\n\n[Install]\nWantedBy=multi-user.target\nEOF\n    echo \"    - æœåŠ¡æ–‡ä»¶ $SERVICE_FILE å·²åˆ›å»º/æ›´æ–°ã€‚\"\nelse\n    echo \"ğŸš¨ é”™è¯¯: Gunicorn è·¯å¾„ $GUNICORN_PATH ä¸å­˜åœ¨ã€‚è¯·ç¡®ä¿è™šæ‹Ÿç¯å¢ƒå’Œä¾èµ–å·²å®‰è£…ï¼\"\n    exit 1\nfi\n\n# 7. å¯åŠ¨å’Œè®¾ç½®å¼€æœºè‡ªå¯\necho \"--- 4. å¯åŠ¨å’Œè®¾ç½®å¼€æœºè‡ªå¯ ---\"\npkill gunicorn 2>/dev/null || true \n\nsudo systemctl daemon-reload\nsudo systemctl enable $SERVICE_NAME\nsudo systemctl restart $SERVICE_NAME\n\n# 8. æœ€ç»ˆçŠ¶æ€æ£€æŸ¥\necho \"--- 5. æœ€ç»ˆçŠ¶æ€æ£€æŸ¥ ---\"\nsudo systemctl status $SERVICE_NAME | head -n 5\necho \"---\"\necho \"éƒ¨ç½²å®Œæˆï¼æœåŠ¡å: $SERVICE_NAMEã€‚è¯·æ£€æŸ¥é˜²ç«å¢™ $PORT ç«¯å£æ˜¯å¦å¼€æ”¾ã€‚\"",
      "lines": 134,
      "added_time": "2025-11-26T14:49:38Z"
    },
    {
      "id": 6,
      "name": "ç«¯å£å¼ºåˆ¶æ€-å½»åº•é‡Šæ”¾ç«¯å£",
      "content": "#!/bin/bash\n\n# Python è™šæ‹Ÿç¯å¢ƒè¿›ç¨‹å¼ºæ€å·¥å…·\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[1;33m'\nBLUE='\\033[0;34m'\nNC='\\033[0m'\n\necho -e \"${BLUE}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}\"\necho -e \"${BLUE}â•‘  Python venv è¿›ç¨‹å¼ºæ€å·¥å…· v1.0  â•‘${NC}\"\necho -e \"${BLUE}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}\\n\"\n\nread -p \"è¾“å…¥ç«¯å£å·: \" PORT\n[ -z \"$PORT\" ] && echo \"ç«¯å£ä¸ºç©º\" && exit 1\n\necho \"\"\necho -e \"${YELLOW}ğŸ” ç¬¬ä¸€æ­¥ï¼šæŸ¥æ‰¾è¿›ç¨‹${NC}\"\necho \"â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\"\n\nPIDS=$(sudo lsof -ti :$PORT 2>/dev/null)\n\nif [ -z \"$PIDS\" ]; then\n    echo -e \"${GREEN}âœ“ ç«¯å£ $PORT æœªè¢«å ç”¨${NC}\"\n    exit 0\nfi\n\necho \"æ‰¾åˆ°è¿›ç¨‹:\"\nfor pid in $PIDS; do\n    CMD=$(ps -o cmd= -p $pid 2>/dev/null)\n    USER=$(ps -o user= -p $pid 2>/dev/null)\n    echo \"  PID: $pid\"\n    echo \"  ç”¨æˆ·: $USER\"\n    echo \"  å‘½ä»¤: $CMD\"\n    echo \"\"\ndone\n\nread -p \"ç¡®è®¤å¼ºæ€? (y/n): \" CONFIRM\n[ \"$CONFIRM\" != \"y\" ] && exit 0\n\n# ============ å…³é”®ï¼šå…ˆç¦ç”¨ systemd è‡ªå¯ ============\necho \"\"\necho -e \"${RED}âš ï¸  ç¬¬äºŒæ­¥ï¼šç¦ç”¨ systemd è‡ªå¯ï¼ˆæœ€å…³é”®ï¼ï¼‰${NC}\"\necho \"â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\"\n\n# æ–¹æ¡ˆ1: æ‰¾åˆ°æ‰€æœ‰ç›¸å…³çš„ systemd æœåŠ¡\necho \"æ‰«æ systemd æœåŠ¡...\"\n\nFOUND_SERVICE=0\n\n# æ£€æŸ¥æ ‡å‡†ä½ç½®\nfor SERVICE_FILE in /etc/systemd/system/*.service /etc/systemd/user/*.service; do\n    if [ -f \"$SERVICE_FILE\" ]; then\n        # æ£€æŸ¥æ˜¯å¦åŒ…å«è¯¥ç«¯å£æˆ– gunicorn/python\n        if grep -q \"Port=$PORT\\|:$PORT\\|gunicorn\\|python.*$PORT\" \"$SERVICE_FILE\" 2>/dev/null; then\n            SERVICE_NAME=$(basename \"$SERVICE_FILE\" .service)\n            echo \"  æ‰¾åˆ°æœåŠ¡: $SERVICE_NAME\"\n            \n            # ä¸‰æ­¥èµ°ï¼šåœæ­¢ â†’ ç¦ç”¨ â†’ å±è”½\n            echo \"    åœæ­¢æœåŠ¡...\"\n            sudo systemctl stop \"$SERVICE_NAME\" 2>/dev/null\n            \n            echo \"    ç¦ç”¨è‡ªå¯...\"\n            sudo systemctl disable \"$SERVICE_NAME\" 2>/dev/null\n            \n            echo \"    å±è”½æœåŠ¡...\"\n            sudo systemctl mask \"$SERVICE_NAME\" 2>/dev/null\n            \n            echo -e \"    ${GREEN}âœ“ å·²å®Œå…¨ç¦ç”¨${NC}\"\n            FOUND_SERVICE=1\n        fi\n    fi\ndone\n\n# æ–¹æ¡ˆ2: å¦‚æœæ²¡æ‰¾åˆ°ï¼Œå°è¯•å¸¸è§åç§°\nif [ $FOUND_SERVICE -eq 0 ]; then\n    echo \"æœªåœ¨é…ç½®æ–‡ä»¶ä¸­æ‰¾åˆ°ï¼Œå°è¯•å¸¸è§åç§°...\"\n    \n    for SERVICE_NAME in gunicorn gunicorn.service app.service django.service; do\n        if systemctl list-unit-files 2>/dev/null | grep -q \"^$SERVICE_NAME\"; then\n            echo \"  æ‰¾åˆ°æœåŠ¡: $SERVICE_NAME\"\n            sudo systemctl stop \"$SERVICE_NAME\" 2>/dev/null\n            sudo systemctl disable \"$SERVICE_NAME\" 2>/dev/null\n            sudo systemctl mask \"$SERVICE_NAME\" 2>/dev/null\n            echo -e \"    ${GREEN}âœ“ å·²ç¦ç”¨${NC}\"\n            FOUND_SERVICE=1\n        fi\n    done\nfi\n\nif [ $FOUND_SERVICE -eq 0 ]; then\n    echo -e \"${YELLOW}âš ï¸  æœªæ‰¾åˆ°ç›¸å…³æœåŠ¡ï¼ˆå¯èƒ½ä½¿ç”¨å…¶ä»–æ–¹å¼å¯åŠ¨ï¼‰${NC}\"\nfi\n\n# æ–¹æ¡ˆ3: é‡ç½® systemd\necho \"é‡ç½® systemd çŠ¶æ€...\"\nsudo systemctl daemon-reload\nsudo systemctl reset-failed\necho -e \"${GREEN}âœ“ systemd å·²é‡ç½®${NC}\"\n\n# ============ æ€æ­»æ‰€æœ‰ç›¸å…³è¿›ç¨‹ ============\necho \"\"\necho -e \"${RED}âš¡ ç¬¬ä¸‰æ­¥ï¼šå¼ºæ€è¿›ç¨‹ï¼ˆ20æ¬¡å¾ªç¯ï¼‰${NC}\"\necho \"â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\"\n\nfor pid in $PIDS; do\n    echo \"  å¼ºæ€ PID $pid...\"\n    \n    # æ€å­è¿›ç¨‹\n    CHILDREN=$(pgrep -P $pid 2>/dev/null)\n    if [ ! -z \"$CHILDREN\" ]; then\n        for child in $CHILDREN; do\n            sudo kill -9 $child 2>/dev/null\n        done\n    fi\n    \n    # 20æ¬¡å¾ªç¯å¼ºæ€\n    for ((i=1; i<=20; i++)); do\n        sudo kill -9 $pid 2>/dev/null 2>&1\n        sleep 0.05\n    done\n    \n    echo -e \"    ${GREEN}âœ“ å·²å¼ºæ€${NC}\"\ndone\n\n# ============ æ€æ­»æ‰€æœ‰ç›¸å…³çš„ Python è¿›ç¨‹ ============\necho \"\"\necho -e \"${YELLOW}æ¸…ç†å…¶ä»– Python è¿›ç¨‹...${NC}\"\n\n# æ‰¾è™šæ‹Ÿç¯å¢ƒè·¯å¾„\nVENV_PATHS=$(ps aux | grep -E 'venv|virtualenv' | grep -v grep | awk '{print $12}' | sed 's|/bin/.*||' | sort -u)\n\nif [ ! -z \"$VENV_PATHS\" ]; then\n    for venv_path in $VENV_PATHS; do\n        echo \"  è™šæ‹Ÿç¯å¢ƒ: $venv_path\"\n        VENV_PIDS=$(pgrep -f \"$venv_path\" 2>/dev/null)\n        if [ ! -z \"$VENV_PIDS\" ]; then\n            for venv_pid in $VENV_PIDS; do\n                sudo kill -9 $venv_pid 2>/dev/null\n            done\n            echo \"    âœ“ å·²æ¸…ç†\"\n        fi\n    done\nfi\n\n# ============ éªŒè¯ ============\necho \"\"\necho -e \"${BLUE}ğŸ“‹ ç¬¬å››æ­¥ï¼šéªŒè¯ç»“æœ${NC}\"\necho \"â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\"\n\nsleep 2\n\nCHECK=$(sudo lsof -ti :$PORT 2>/dev/null)\n\nif [ -z \"$CHECK\" ]; then\n    echo -e \"${GREEN}âœ… æˆåŠŸï¼ç«¯å£ $PORT å·²å½»åº•é‡Šæ”¾${NC}\"\n    echo \"\"\n    echo \"éªŒè¯å‘½ä»¤:\"\n    echo \"  sudo lsof -i :$PORT\"\n    echo \"  sudo netstat -tlnp | grep $PORT\"\n    echo \"\"\n    echo \"åç»­æ“ä½œ:\"\n    echo \"  1. ä¿®æ”¹è™šæ‹Ÿç¯å¢ƒçš„ systemd æœåŠ¡é…ç½®\"\n    echo \"  2. æ”¹ Restart=always ä¸º Restart=no\"\n    echo \"  3. æˆ–å®Œå…¨åˆ é™¤æœåŠ¡é…ç½®æ–‡ä»¶\"\n    exit 0\nelse\n    echo -e \"${RED}âš ï¸  è­¦å‘Šï¼šç«¯å£ $CHECK ä»è¢«å ç”¨ï¼${NC}\"\n    echo \"\"\n    echo \"å¯èƒ½åŸå› :\"\n    echo \"  1. systemd åœ¨åå°é‡å¯è¿›ç¨‹\"\n    echo \"  2. è¿˜æœ‰å…¶ä»–ç›‘ç®¡è¿›ç¨‹\"\n    echo \"\"\n    echo \"å¼ºåˆ¶æ–¹æ¡ˆ:\"\n    echo \"  sudo systemctl stop gunicorn\"\n    echo \"  sudo systemctl disable gunicorn\"\n    echo \"  sudo systemctl mask gunicorn\"\n    echo \"  sudo pkill -9 python\"\n    echo \"  sudo pkill -9 gunicorn\"\n    echo \"\"\n    echo \"æœ€åæ‰‹æ®µ:\"\n    echo \"  sudo systemctl daemon-reexec\"\n    echo \"  sudo reboot\"\nfi",
      "lines": 183,
      "added_time": "2025-11-27T13:45:25Z"
    },
    {
      "id": 7,
      "name": "backup VPS 1.0",
      "content": "#!/bin/bash\n# WebDAV VPS å¤‡ä»½ä¸æ¢å¤ç®¡ç†å™¨ (v3.2 - ARM é˜²å¡æ­»æœ€ç»ˆç‰ˆ)\n\n# ==============================================================================\n# ğŸ› ï¸ æ ¸å¿ƒé…ç½®åŒº ğŸ› ï¸\n# ==============================================================================\nWEBDAV_URL=\"https://ajiro.infini-cloud.net/dav/\" \nWEBDAV_USER=\"chf5762\"\nWEBDAV_PASS=\"piNdCJ4EPiw5Wtgn\"\n\nREMOTE_FOLDER=\"archives\" \n\nDB_TYPE=\"mysql\"\nDB_USER=\"root\"\nDB_NAME=\"your_api_database\"   # ä¸éœ€è¦å¤‡ä»½æ•°æ®åº“è¯·ä¿æŒé»˜è®¤æˆ–ç•™ç©º\nMAIN_SERVICE_NAME=\"your-api-service\"\n# ==============================================================================\n\nBACKUP_DIRS=(\"/etc\" \"/root\" \"/home\" \"/var/www\" \"/srv\" \"/opt\" \"/var/spool/cron\" \"/etc/letsencrypt\")\n\n# æ’é™¤åˆ—è¡¨ (v3.2: å³ä½¿æœ‰ --one-file-systemï¼Œè¿™äº›æ˜¾å¼æ’é™¤ä¾ç„¶ä¿ç•™ä½œä¸ºåŒé‡ä¿é™©)\nEXCLUDE_PATTERNS=(\n    \"*.sock\" \n    \"*.log\" \n    \"*.lock\"\n    \"*.iso\"\n    \"*.tar.gz\"\n    \"/var/cache/*\" \n    \"/var/tmp/*\" \n    \"/tmp/*\"\n    \"/var/lib/apt/lists/*\" \n    \"/home/*/.cache\" \n    \"/home/*/Downloads\"\n    \"/etc/unified-monitoring-agenttmp\"\n    \"/proc/*\"\n    \"/sys/*\"\n    \"/run/*\"\n    \"/mnt/*\"\n    \"/media/*\"\n    \"/dev/*\"\n    \"/lost+found\"\n    \"/swapfile\"\n)\n\nREMOTE_NAME=\"mywebdav\"\n\n# --- 0. ç¯å¢ƒè‡ªæ£€ ---\nprepare_environment() {\n    echo \"--- ğŸ› ï¸ æ­£åœ¨æ£€æŸ¥ç³»ç»Ÿç¯å¢ƒä¸ä¾èµ– ---\"\n    local PM=\"\"\n    if command -v apt-get >/dev/null; then PM=\"apt\";\n    elif command -v yum >/dev/null; then PM=\"yum\";\n    elif command -v dnf >/dev/null; then PM=\"dnf\";\n    elif command -v apk >/dev/null; then PM=\"apk\";\n    else echo \"âŒ æ— æ³•è¯†åˆ«åŒ…ç®¡ç†å™¨ï¼Œè¯·æ‰‹åŠ¨å®‰è£… unzip curl tar sudoã€‚\"; exit 1; fi\n\n    local TOOLS=\"curl wget unzip tar sudo\"\n    local MISSING_TOOLS=\"\"\n    for tool in $TOOLS; do\n        if ! command -v $tool >/dev/null; then MISSING_TOOLS=\"$MISSING_TOOLS $tool\"; fi\n    done\n\n    if [ -n \"$MISSING_TOOLS\" ]; then\n        echo \"ğŸ”„ æ­£åœ¨è‡ªåŠ¨å®‰è£…ä¾èµ–: $MISSING_TOOLS\"\n        if [ \"$PM\" == \"apt\" ]; then sudo apt-get update -y -q && sudo apt-get install -y -q $MISSING_TOOLS\n        elif [ \"$PM\" == \"yum\" ] || [ \"$PM\" == \"dnf\" ]; then sudo $PM install -y $MISSING_TOOLS\n        elif [ \"$PM\" == \"apk\" ]; then sudo apk add --no-cache $MISSING_TOOLS\n        fi\n    else\n        echo \"âœ… ç³»ç»Ÿç¯å¢ƒä¾èµ–æ­£å¸¸ã€‚\"\n    fi\n}\n\n# --- 1. Rclone é…ç½® ---\ncheck_and_configure_rclone() {\n    prepare_environment\n    if ! command -v rclone >/dev/null; then\n        echo \"--- â˜ï¸ æ­£åœ¨å®‰è£… Rclone ---\"\n        sudo -v ; curl https://rclone.org/install.sh | sudo bash\n    fi\n\n    if rclone listremotes | grep -q \"^${REMOTE_NAME}:\"; then\n        return 0\n    else\n        echo \"--- âš™ï¸ æ­£åœ¨ç”Ÿæˆ Rclone é…ç½®æ–‡ä»¶ ---\"\n        local OB_PASS=$(rclone obscure \"${WEBDAV_PASS}\")\n        mkdir -p ~/.config/rclone\n        rclone config create \"${REMOTE_NAME}\" webdav url=\"${WEBDAV_URL}\" user=\"${WEBDAV_USER}\" pass=\"${OB_PASS}\" vendor=\"other\" --non-interactive >/dev/null 2>&1\n        if [ $? -eq 0 ]; then echo \"âœ… Rclone é…ç½®æˆåŠŸï¼\"; else echo \"âŒ Rclone é…ç½®ç”Ÿæˆå¤±è´¥ã€‚\"; exit 1; fi\n    fi\n}\n\n# --- 2. æ•°æ®åº“å¤‡ä»½ ---\ndo_db_backup() {\n    local DEST_PATH=$1\n    if [ \"$DB_NAME\" == \"your_api_database\" ] || [ -z \"$DB_NAME\" ]; then\n        echo \"â„¹ï¸ è·³è¿‡æ•°æ®åº“å¤‡ä»½ (æœªé…ç½® DB_NAME)ã€‚\"\n        return 0\n    fi\n\n    local DB_BACKUP_FILE=\"${DEST_PATH}/${DB_NAME}_db_backup.sql\"\n    echo \"--- ğŸ“Š æ­£åœ¨å¯¼å‡ºæ•°æ®åº“: ${DB_NAME} ---\"\n\n    if [ \"${DB_TYPE}\" == \"mysql\" ]; then\n        mysqldump -u \"${DB_USER}\" \"${DB_NAME}\" > \"${DB_BACKUP_FILE}\" 2>/dev/null\n    elif [ \"${DB_TYPE}\" == \"postgresql\" ]; then\n        pg_dump -U \"${DB_USER}\" \"${DB_NAME}\" > \"${DB_BACKUP_FILE}\" 2>/dev/null\n    fi\n\n    if [ -s \"${DB_BACKUP_FILE}\" ]; then echo \"âœ… æ•°æ®åº“å¯¼å‡ºæˆåŠŸã€‚\"; else rm -f \"${DB_BACKUP_FILE}\"; fi\n}\n\n# --- 3. ç³»ç»ŸçŠ¶æ€å¤‡ä»½ ---\ndo_system_check_backup() {\n    local DEST_PATH=$1\n    if [ -z \"$MAIN_SERVICE_NAME\" ] || [ \"$MAIN_SERVICE_NAME\" == \"your-api-service\" ]; then return 0; fi\n    local STATE_FILE=\"${DEST_PATH}/system_state.txt\"\n    if systemctl is-enabled \"${MAIN_SERVICE_NAME}\" >/dev/null 2>&1; then echo \"SERVICE_ENABLED=true\" > \"${STATE_FILE}\"; else echo \"SERVICE_ENABLED=false\" > \"${STATE_FILE}\"; fi\n    if [ -f \"/etc/ssh/sshd_config\" ]; then stat -c \"SSHD_CONFIG_PERMS=%a\" /etc/ssh/sshd_config >> \"${STATE_FILE}\"; fi\n}\n\n# --- 4. æ¢å¤é€»è¾‘ ---\ndo_system_restore() {\n    local RESTORE_PATH=$1\n    if [ -z \"$MAIN_SERVICE_NAME\" ] || [ \"$MAIN_SERVICE_NAME\" == \"your-api-service\" ]; then return 0; fi\n    local STATE_FILE=\"${RESTORE_PATH}/system_state.txt\"\n    echo \"--- ğŸ”„ æ¢å¤æœåŠ¡çŠ¶æ€ ---\"\n    sudo systemctl daemon-reload\n    if [ -f \"${STATE_FILE}\" ]; then\n        source \"${STATE_FILE}\"\n        if [ \"${SERVICE_ENABLED}\" == \"true\" ]; then sudo systemctl enable \"${MAIN_SERVICE_NAME}\" 2>/dev/null; sudo systemctl start \"${MAIN_SERVICE_NAME}\" 2>/dev/null; else sudo systemctl disable \"${MAIN_SERVICE_NAME}\" 2>/dev/null; fi\n        [ -n \"${SSHD_CONFIG_PERMS}\" ] && chmod \"${SSHD_CONFIG_PERMS}\" /etc/ssh/sshd_config 2>/dev/null\n    fi\n}\n\n# --- åŠŸèƒ½: å¤‡ä»½ (é˜²å¡æ­»ç‰ˆ) ---\nbackup_to_webdav() {\n    check_and_configure_rclone\n\n    local TEMP_DIR=\"/tmp/vps_backup_temp_$(date +%s)\"\n    local TIMESTAMP=$(date +%Y%m%d_%H%M%S)\n    local HOSTNAME=$(hostname)\n    local ARCHIVE_NAME=\"full_backup_${HOSTNAME}_${TIMESTAMP}.tar.gz\"\n    local LOCAL_BACKUP_FOLDER=\"${TEMP_DIR}/payload\"\n    \n    echo \"--- ğŸš€ å¼€å§‹å¤‡ä»½ (ARM ä¼˜åŒ–æ¨¡å¼) ---\"\n    \n    mkdir -p \"${LOCAL_BACKUP_FOLDER}\"\n    do_db_backup \"${LOCAL_BACKUP_FOLDER}\"\n    do_system_check_backup \"${LOCAL_BACKUP_FOLDER}\"\n\n    local TEMP_FILE=\"/tmp/backup_list.txt\"\n    rm -f \"${TEMP_FILE}\"\n    for dir in \"${BACKUP_DIRS[@]}\"; do [ -d \"$dir\" ] && echo \"$dir\" >> \"${TEMP_FILE}\"; done\n\n    echo \"--- ğŸ“¦ æ­£åœ¨æ‰“åŒ… (å·²å¯ç”¨ 'é˜²è·¨æ–‡ä»¶ç³»ç»Ÿ' ä¿æŠ¤) ---\"\n    echo \"â„¹ï¸  æ­£åœ¨ç”Ÿæˆå‹ç¼©åŒ…ï¼Œæ‚¨å°†çœ‹åˆ°æ–‡ä»¶åˆ—è¡¨æ»šåŠ¨ï¼Œè¯æ˜æ²¡æœ‰å¡æ­»...\"\n    \n    # æ ¸å¿ƒä¿®æ”¹ï¼š\n    # 1. nice -n 10: é™ä½ CPU ä¼˜å…ˆçº§ï¼Œé˜²æ­¢ ARM æœºå™¨ SSH å¡æ­»\n    # 2. --one-file-system: å…³é”®å‚æ•°ï¼é˜²æ­¢è¯»å– /proc è™šæ‹Ÿæ–‡ä»¶å¯¼è‡´æ— é™ç­‰å¾…\n    # 3. -v: æ˜¾ç¤ºæ–‡ä»¶åˆ—è¡¨ï¼Œè®©ç”¨æˆ·çŸ¥é“è¿›åº¦\n    # 4. è¿™é‡Œçš„ stderr é‡å®šå‘è¢«ç§»é™¤ï¼Œä»¥ä¾¿çœ‹åˆ°ä»»ä½•é”™è¯¯\n    \n    sudo nice -n 10 tar -zcvf \"${TEMP_DIR}/${ARCHIVE_NAME}\" \\\n        --one-file-system \\\n        -C / -T \"${TEMP_FILE}\" \\\n        $(for pattern in \"${EXCLUDE_PATTERNS[@]}\"; do echo \"--exclude='${pattern}'\"; done) \\\n        --directory=\"${TEMP_DIR}\" \"payload\" \\\n        | awk 'NR%100==0 {printf \"\\rå·²å¤„ç† %d ä¸ªæ–‡ä»¶...\", NR} END {print \"\\ræ‰“åŒ…å®Œæˆï¼\"}'\n\n    TAR_EXIT_CODE=${PIPESTATUS[0]} # è·å–ç®¡é“å‰ tar çš„é€€å‡ºç \n\n    # 0 = æˆåŠŸ, 1 = æœ‰è­¦å‘Š (æ­£å¸¸)\n    if [ $TAR_EXIT_CODE -eq 0 ] || [ $TAR_EXIT_CODE -eq 1 ]; then\n        echo -e \"\\nâœ… æ‰“åŒ…æˆåŠŸã€‚\"\n    else\n        echo -e \"\\nâŒ æ‰“åŒ…å¤±è´¥ (é”™è¯¯ç : $TAR_EXIT_CODE)ã€‚\"\n        rm -rf \"${TEMP_DIR}\"\n        return 1\n    fi\n\n    echo \"--- ğŸ“¤ æ­£åœ¨ä¸Šä¼ åˆ° WebDAV ---\"\n    rclone copy \"${TEMP_DIR}/${ARCHIVE_NAME}\" \"${REMOTE_NAME}:${REMOTE_FOLDER}/\" --progress\n\n    if [ $? -eq 0 ]; then echo \"âœ… å¤‡ä»½ä¸Šä¼ æˆåŠŸï¼\"; else echo \"âŒ ä¸Šä¼ å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œã€‚\"; fi\n\n    rm -f \"${TEMP_FILE}\"\n    sudo rm -rf \"${TEMP_DIR}\"\n}\n\n# --- åŠŸèƒ½: æ¢å¤ ---\nrestore_from_webdav() {\n    check_and_configure_rclone\n    echo \"--- ğŸ“¥ è·å–è¿œç¨‹å¤‡ä»½åˆ—è¡¨ ---\"\n    mapfile -t BACKUP_FILES < <(rclone lsf \"${REMOTE_NAME}:${REMOTE_FOLDER}/\" --files-only --include \"*.tar.gz\" | sort -r)\n\n    if [ ${#BACKUP_FILES[@]} -eq 0 ]; then echo \"âŒ æœªæ‰¾åˆ°å¤‡ä»½æ–‡ä»¶ã€‚\"; return 1; fi\n\n    local i=1\n    for file in \"${BACKUP_FILES[@]}\"; do echo \"$i) $file\"; i=$((i + 1)); done\n\n    read -p \"è¯·è¾“å…¥åºå·: \" CHOICE\n    if ! [[ \"$CHOICE\" =~ ^[0-9]+$ ]] || [ \"$CHOICE\" -lt 1 ] || [ \"$CHOICE\" -gt ${#BACKUP_FILES[@]} ]; then echo \"æ— æ•ˆè¾“å…¥\"; return 1; fi\n    \n    local SELECTED_FILE=\"${BACKUP_FILES[$((CHOICE - 1))]}\"\n    \n    echo \"âš ï¸  æ³¨æ„ï¼šå³å°†è¦†ç›–ç³»ç»Ÿæ–‡ä»¶ï¼\"\n    read -r -p \"ç¡®è®¤è¯·è¾“å…¥ YES : \" response\n    if [ \"$response\" != \"YES\" ]; then echo \"å·²å–æ¶ˆã€‚\"; return 0; fi\n\n    local TEMP_DIR=\"/tmp/restore_temp_$(date +%s)\"\n    mkdir -p \"${TEMP_DIR}\"\n    echo \"--- â¬‡ï¸ ä¸‹è½½å¤‡ä»½... ---\"\n    rclone copy \"${REMOTE_NAME}:${REMOTE_FOLDER}/${SELECTED_FILE}\" \"${TEMP_DIR}/\" --progress\n\n    echo \"--- ğŸ”„ è§£å‹è¦†ç›–... ---\"\n    # è§£å‹ä¹ŸåŠ ä¸Š --overwrite ç¡®ä¿è¦†ç›–\n    sudo tar -xzpf \"${TEMP_DIR}/${SELECTED_FILE}\" -C /\n    \n    local RESTORE_PATH=\"/payload\"\n    if [ -d \"${RESTORE_PATH}\" ]; then\n        do_system_restore \"${RESTORE_PATH}\"\n        sudo rm -rf \"${RESTORE_PATH}\"\n    fi\n\n    sudo rm -rf \"${TEMP_DIR}\"\n    echo \"--- âœ… æ¢å¤å®Œæˆï¼ ---\"\n}\n\n# --- Cron ---\nsetup_cron() {\n    read -p \"é¢‘ç‡ (1=æ¯æ—¥ 2=æ¯å‘¨ 3=æ¯æœˆ): \" FREQUENCY\n    case \"$FREQUENCY\" in\n        1) SCHEDULE=\"0 3 * * *\" ;;\n        2) SCHEDULE=\"0 3 * * 0\" ;;\n        3) SCHEDULE=\"0 3 1 * *\" ;;\n        *) echo \"æ— æ•ˆ\"; return 1;;\n    esac\n    local SCRIPT_PATH=$(realpath \"$0\")\n    local CRON_JOB=\"${SCHEDULE} root bash ${SCRIPT_PATH} execute_backup >> /var/log/vps_backup.log 2>&1\"\n    (sudo crontab -l 2>/dev/null | grep -v \"execute_backup\") | sudo crontab -\n    (sudo crontab -l 2>/dev/null; echo \"${CRON_JOB}\") | sudo crontab -\n    echo \"âœ… å®šæ—¶ä»»åŠ¡å·²è®¾ç½®ã€‚\"\n}\n\n# --- Main ---\nif [ \"$1\" == \"execute_backup\" ]; then backup_to_webdav; exit $?; fi\nif [ \"$(id -u)\" != \"0\" ]; then echo \"è¯·ä½¿ç”¨ sudo\"; exit 1; fi\n\nwhile true; do\n    echo \"WebDAV å¤‡ä»½ç®¡ç†å™¨ (v3.2 ARM é˜²å¡æ­»ç‰ˆ)\"\n    echo \"1) åˆå§‹åŒ–\"\n    echo \"2) å¤‡ä»½\"\n    echo \"3) æ¢å¤\"\n    echo \"4) å®šæ—¶ä»»åŠ¡\"\n    echo \"5) é€€å‡º\"\n    read -p \"é€‰æ‹©: \" CHOICE\n    case \"$CHOICE\" in\n        1) check_and_configure_rclone;;\n        2) backup_to_webdav;;\n        3) restore_from_webdav;;\n        4) setup_cron;;\n        5) exit 0;;\n    esac\ndone",
      "lines": 265,
      "added_time": "2025-12-09T07:45:01Z"
    },
    {
      "id": 8,
      "name": "docker manager",
      "content": "#!/bin/bash\n\n# Docker å…¨æ–¹ä½ç®¡ç†è„šæœ¬\n# åŠŸèƒ½ï¼šå®¹å™¨å’Œé•œåƒçš„å…¨æ–¹ä½ç®¡ç†ï¼Œæ”¯æŒæ‰¹é‡æ“ä½œ\n\n# é¢œè‰²å®šä¹‰\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[1;33m'\nBLUE='\\033[0;34m'\nCYAN='\\033[0;36m'\nNC='\\033[0m' # æ— é¢œè‰²\n\n# æ£€æŸ¥ Docker æ˜¯å¦å®‰è£…å’Œè¿è¡Œ\ncheck_docker() {\n    if ! command -v docker &> /dev/null; then\n        echo -e \"${RED}é”™è¯¯ï¼šDocker æœªå®‰è£…${NC}\"\n        exit 1\n    fi\n    \n    if ! docker ps &> /dev/null; then\n        echo -e \"${RED}é”™è¯¯ï¼šæ— æ³•è¿æ¥åˆ° Dockerï¼Œè¯·æ£€æŸ¥ Docker æœåŠ¡æ˜¯å¦è¿è¡Œæˆ–æƒé™æ˜¯å¦è¶³å¤Ÿ${NC}\"\n        exit 1\n    fi\n}\n\n# æ‰“å°åˆ†éš”çº¿\nprint_line() {\n    echo -e \"${CYAN}========================================${NC}\"\n}\n\n# æ˜¾ç¤ºä¸»èœå•\nshow_main_menu() {\n    clear\n    print_line\n    echo -e \"${CYAN}          Docker ç®¡ç†å·¥å…·${NC}\"\n    print_line\n    echo -e \"${YELLOW}1.${NC} å®¹å™¨ç®¡ç†\"\n    echo -e \"${YELLOW}2.${NC} é•œåƒç®¡ç†\"\n    echo -e \"${YELLOW}3.${NC} é€€å‡º\"\n    print_line\n}\n\n# æ˜¾ç¤ºå®¹å™¨ç®¡ç†èœå•\nshow_container_menu() {\n    clear\n    print_line\n    echo -e \"${CYAN}          å®¹å™¨ç®¡ç†${NC}\"\n    print_line\n    echo -e \"${YELLOW}1.${NC} åˆ—å‡ºæ‰€æœ‰å®¹å™¨\"\n    echo -e \"${YELLOW}2.${NC} å¯åŠ¨å®¹å™¨\"\n    echo -e \"${YELLOW}3.${NC} åœæ­¢å®¹å™¨\"\n    echo -e \"${YELLOW}4.${NC} é‡å¯å®¹å™¨\"\n    echo -e \"${YELLOW}5.${NC} åˆ é™¤å®¹å™¨ï¼ˆå¼ºåˆ¶ï¼‰\"\n    echo -e \"${YELLOW}6.${NC} æŸ¥çœ‹å®¹å™¨æ—¥å¿—\"\n    echo -e \"${YELLOW}7.${NC} è¿”å›ä¸»èœå•\"\n    print_line\n}\n\n# æ˜¾ç¤ºé•œåƒç®¡ç†èœå•\nshow_image_menu() {\n    clear\n    print_line\n    echo -e \"${CYAN}          é•œåƒç®¡ç†${NC}\"\n    print_line\n    echo -e \"${YELLOW}1.${NC} åˆ—å‡ºæ‰€æœ‰é•œåƒ\"\n    echo -e \"${YELLOW}2.${NC} åˆ é™¤é•œåƒï¼ˆå¼ºåˆ¶ï¼‰\"\n    echo -e \"${YELLOW}3.${NC} æ¸…ç†æœªä½¿ç”¨çš„é•œåƒ\"\n    echo -e \"${YELLOW}4.${NC} è¿”å›ä¸»èœå•\"\n    print_line\n}\n\n# åˆ—å‡ºæ‰€æœ‰å®¹å™¨\nlist_containers() {\n    clear\n    print_line\n    echo -e \"${CYAN}          å®¹å™¨åˆ—è¡¨${NC}\"\n    print_line\n    \n    # è¿è¡Œä¸­çš„å®¹å™¨\n    echo -e \"\\n${GREEN}è¿è¡Œä¸­çš„å®¹å™¨ï¼š${NC}\"\n    running_containers=($(docker ps --format \"{{.ID}}\"))\n    \n    if [ ${#running_containers[@]} -eq 0 ]; then\n        echo \"  æ— è¿è¡Œä¸­çš„å®¹å™¨\"\n    else\n        printf \"%-6s %-15s %-25s %-15s %-30s\\n\" \"ç¼–å·\" \"å®¹å™¨ID\" \"åç§°\" \"çŠ¶æ€\" \"ç«¯å£\"\n        echo \"---------------------------------------------------------------------------------------------------\"\n        for i in \"${!running_containers[@]}\"; do\n            id=\"${running_containers[$i]}\"\n            name=$(docker ps --filter \"id=$id\" --format \"{{.Names}}\")\n            status=$(docker ps --filter \"id=$id\" --format \"{{.Status}}\")\n            ports=$(docker ps --filter \"id=$id\" --format \"{{.Ports}}\")\n            printf \"${GREEN}%-6s %-15s %-25s %-15s %-30s${NC}\\n\" \"$((i+1))\" \"${id:0:12}\" \"$name\" \"è¿è¡Œä¸­\" \"$ports\"\n        done\n    fi\n    \n    # å·²åœæ­¢çš„å®¹å™¨\n    echo -e \"\\n${RED}å·²åœæ­¢çš„å®¹å™¨ï¼š${NC}\"\n    stopped_containers=($(docker ps -a --filter \"status=exited\" --filter \"status=created\" --format \"{{.ID}}\"))\n    \n    if [ ${#stopped_containers[@]} -eq 0 ]; then\n        echo \"  æ— å·²åœæ­¢çš„å®¹å™¨\"\n    else\n        printf \"%-6s %-15s %-25s %-15s %-30s\\n\" \"ç¼–å·\" \"å®¹å™¨ID\" \"åç§°\" \"çŠ¶æ€\" \"ç«¯å£\"\n        echo \"---------------------------------------------------------------------------------------------------\"\n        offset=${#running_containers[@]}\n        for i in \"${!stopped_containers[@]}\"; do\n            id=\"${stopped_containers[$i]}\"\n            name=$(docker ps -a --filter \"id=$id\" --format \"{{.Names}}\")\n            status=$(docker ps -a --filter \"id=$id\" --format \"{{.Status}}\")\n            ports=$(docker ps -a --filter \"id=$id\" --format \"{{.Ports}}\")\n            printf \"${RED}%-6s %-15s %-25s %-15s %-30s${NC}\\n\" \"$((offset+i+1))\" \"${id:0:12}\" \"$name\" \"å·²åœæ­¢\" \"$ports\"\n        done\n    fi\n    \n    print_line\n}\n\n# è·å–æ‰€æœ‰å®¹å™¨ï¼ˆè¿è¡Œä¸­+å·²åœæ­¢ï¼‰\nget_all_containers() {\n    running=($(docker ps --format \"{{.ID}}\"))\n    stopped=($(docker ps -a --filter \"status=exited\" --filter \"status=created\" --format \"{{.ID}}\"))\n    all_containers=(\"${running[@]}\" \"${stopped[@]}\")\n}\n\n# å¯åŠ¨å®¹å™¨\nstart_containers() {\n    list_containers\n    get_all_containers\n    \n    if [ ${#all_containers[@]} -eq 0 ]; then\n        echo -e \"${YELLOW}æ²¡æœ‰å¯ç”¨çš„å®¹å™¨${NC}\"\n        read -p \"æŒ‰å›è½¦é”®ç»§ç»­...\"\n        return\n    fi\n    \n    echo -e \"\\n${CYAN}è¯·è¾“å…¥è¦å¯åŠ¨çš„å®¹å™¨ç¼–å·ï¼ˆç©ºæ ¼åˆ†éš”ï¼Œå¦‚ï¼š1 2 3ï¼‰ï¼š${NC}\"\n    read -r input\n    \n    if [ -z \"$input\" ]; then\n        return\n    fi\n    \n    for num in $input; do\n        if [[ \"$num\" =~ ^[0-9]+$ ]] && [ \"$num\" -ge 1 ] && [ \"$num\" -le ${#all_containers[@]} ]; then\n            container_id=\"${all_containers[$((num-1))]}\"\n            echo -e \"${GREEN}æ­£åœ¨å¯åŠ¨å®¹å™¨ $num: $container_id${NC}\"\n            docker start \"$container_id\"\n        else\n            echo -e \"${RED}æ— æ•ˆçš„ç¼–å·: $num${NC}\"\n        fi\n    done\n    \n    echo -e \"${GREEN}æ“ä½œå®Œæˆ${NC}\"\n    read -p \"æŒ‰å›è½¦é”®ç»§ç»­...\"\n}\n\n# åœæ­¢å®¹å™¨\nstop_containers() {\n    list_containers\n    get_all_containers\n    \n    if [ ${#all_containers[@]} -eq 0 ]; then\n        echo -e \"${YELLOW}æ²¡æœ‰å¯ç”¨çš„å®¹å™¨${NC}\"\n        read -p \"æŒ‰å›è½¦é”®ç»§ç»­...\"\n        return\n    fi\n    \n    echo -e \"\\n${CYAN}è¯·è¾“å…¥è¦åœæ­¢çš„å®¹å™¨ç¼–å·ï¼ˆç©ºæ ¼åˆ†éš”ï¼Œå¦‚ï¼š1 2 3ï¼‰ï¼š${NC}\"\n    read -r input\n    \n    if [ -z \"$input\" ]; then\n        return\n    fi\n    \n    for num in $input; do\n        if [[ \"$num\" =~ ^[0-9]+$ ]] && [ \"$num\" -ge 1 ] && [ \"$num\" -le ${#all_containers[@]} ]; then\n            container_id=\"${all_containers[$((num-1))]}\"\n            echo -e \"${YELLOW}æ­£åœ¨åœæ­¢å®¹å™¨ $num: $container_id${NC}\"\n            docker stop \"$container_id\"\n        else\n            echo -e \"${RED}æ— æ•ˆçš„ç¼–å·: $num${NC}\"\n        fi\n    done\n    \n    echo -e \"${GREEN}æ“ä½œå®Œæˆ${NC}\"\n    read -p \"æŒ‰å›è½¦é”®ç»§ç»­...\"\n}\n\n# é‡å¯å®¹å™¨\nrestart_containers() {\n    list_containers\n    get_all_containers\n    \n    if [ ${#all_containers[@]} -eq 0 ]; then\n        echo -e \"${YELLOW}æ²¡æœ‰å¯ç”¨çš„å®¹å™¨${NC}\"\n        read -p \"æŒ‰å›è½¦é”®ç»§ç»­...\"\n        return\n    fi\n    \n    echo -e \"\\n${CYAN}è¯·è¾“å…¥è¦é‡å¯çš„å®¹å™¨ç¼–å·ï¼ˆç©ºæ ¼åˆ†éš”ï¼Œå¦‚ï¼š1 2 3ï¼‰ï¼š${NC}\"\n    read -r input\n    \n    if [ -z \"$input\" ]; then\n        return\n    fi\n    \n    for num in $input; do\n        if [[ \"$num\" =~ ^[0-9]+$ ]] && [ \"$num\" -ge 1 ] && [ \"$num\" -le ${#all_containers[@]} ]; then\n            container_id=\"${all_containers[$((num-1))]}\"\n            echo -e \"${BLUE}æ­£åœ¨é‡å¯å®¹å™¨ $num: $container_id${NC}\"\n            docker restart \"$container_id\"\n        else\n            echo -e \"${RED}æ— æ•ˆçš„ç¼–å·: $num${NC}\"\n        fi\n    done\n    \n    echo -e \"${GREEN}æ“ä½œå®Œæˆ${NC}\"\n    read -p \"æŒ‰å›è½¦é”®ç»§ç»­...\"\n}\n\n# åˆ é™¤å®¹å™¨ï¼ˆå¼ºåˆ¶ï¼‰\nremove_containers() {\n    list_containers\n    get_all_containers\n    \n    if [ ${#all_containers[@]} -eq 0 ]; then\n        echo -e \"${YELLOW}æ²¡æœ‰å¯ç”¨çš„å®¹å™¨${NC}\"\n        read -p \"æŒ‰å›è½¦é”®ç»§ç»­...\"\n        return\n    fi\n    \n    echo -e \"\\n${RED}è¯·è¾“å…¥è¦åˆ é™¤çš„å®¹å™¨ç¼–å·ï¼ˆç©ºæ ¼åˆ†éš”ï¼Œå¦‚ï¼š1 2 3ï¼‰ï¼š${NC}\"\n    read -r input\n    \n    if [ -z \"$input\" ]; then\n        return\n    fi\n    \n    for num in $input; do\n        if [[ \"$num\" =~ ^[0-9]+$ ]] && [ \"$num\" -ge 1 ] && [ \"$num\" -le ${#all_containers[@]} ]; then\n            container_id=\"${all_containers[$((num-1))]}\"\n            echo -e \"${RED}æ­£åœ¨å¼ºåˆ¶åˆ é™¤å®¹å™¨ $num: $container_id${NC}\"\n            docker rm -f \"$container_id\"\n        else\n            echo -e \"${RED}æ— æ•ˆçš„ç¼–                          : $num${NC}\"\n        fi\n    done\n    \n    echo -e \"${GREEN}æ“ä½œå®Œæˆ${NC}\"\n    read -p \"æŒ‰å›è½¦é”®ç»§ç»­...\"\n}\n\n# æŸ¥çœ‹å®¹å™¨æ—¥å¿—\nview_container_logs() {\n    list_containers\n    get_all_containers\n    \n    if [ ${#all_containers[@]} -eq 0 ]; then\n        echo -e \"${YELLOW}æ²¡æœ‰å¯ç”¨çš„å®¹å™¨${NC}\"\n        read -p \"æŒ‰å›è½¦é”®ç»§ç»­...\"\n        return\n    fi\n    \n    echo -e \"\\n${CYAN}è¯·è¾“å…¥è¦æŸ¥çœ‹æ—¥å¿—çš„å®¹å™¨ç¼–å·ï¼š${NC}\"\n    read -r num\n    \n    if [[ \"$num\" =~ ^[0-9]+$ ]] && [ \"$num\" -ge 1 ] && [ \"$num\" -le ${#all_containers[@]} ]; then\n        container_id=\"${all_containers[$((num-1))]}\"\n        echo -e \"${BLUE}æ˜¾ç¤ºå®¹å™¨æ—¥å¿—ï¼ˆæœ€å100è¡Œï¼‰: $container_id${NC}\"\n        print_line\n        docker logs --tail 100 \"$container_id\"\n        print_line\n    else\n        echo -e \"${RED}æ— æ•ˆçš„ç¼–å·${NC}\"\n    fi\n    \n    read -p \"æŒ‰å›è½¦é”®ç»§ç»­...\"\n}\n\n# åˆ—å‡ºæ‰€æœ‰é•œåƒ\nlist_images() {\n    clear\n    print_line\n    echo -e \"${CYAN}          é•œåƒåˆ—è¡¨${NC}\"\n    print_line\n    \n    images=($(docker images --format \"{{.ID}}\"))\n    \n    if [ ${#images[@]} -eq 0 ]; then\n        echo -e \"${YELLOW}æ²¡æœ‰å¯ç”¨çš„é•œåƒ${NC}\"\n    else\n        printf \"\\n%-6s %-20s %-30s %-15s %-20s\\n\" \"ç¼–å·\" \"é•œåƒID\" \"ä»“åº“\" \"æ ‡ç­¾\" \"å¤§å°\"\n        echo \"---------------------------------------------------------------------------------------------------\"\n        for i in \"${!images[@]}\"; do\n            id=\"${images[$i]}\"\n            repo=$(docker images --filter \"id=$id\" --format \"{{.Repository}}\")\n            tag=$(docker images --filter \"id=$id\" --format \"{{.Tag}}\")\n            size=$(docker images --filter \"id=$id\" --format \"{{.Size}}\")\n            printf \"${BLUE}%-6s %-20s %-30s %-15s %-20s${NC}\\n\" \"$((i+1))\" \"${id:0:12}\" \"$repo\" \"$tag\" \"$size\"\n        done\n    fi\n    \n    print_line\n}\n\n# åˆ é™¤é•œåƒï¼ˆå¼ºåˆ¶ï¼‰\nremove_images() {\n    list_images\n    images=($(docker images --format \"{{.ID}}\"))\n    \n    if [ ${#images[@]} -eq 0 ]; then\n        echo -e \"${YELLOW}æ²¡æœ‰å¯ç”¨çš„é•œåƒ${NC}\"\n        read -p \"æŒ‰å›è½¦é”®ç»§ç»­...\"\n        return\n    fi\n    \n    echo -e \"\\n${RED}è¯·è¾“å…¥è¦åˆ é™¤çš„é•œåƒç¼–å·ï¼ˆç©ºæ ¼åˆ†éš”ï¼Œå¦‚ï¼š1 2 3ï¼‰ï¼š${NC}\"\n    read -r input\n    \n    if [ -z \"$input\" ]; then\n        return\n    fi\n    \n    for num in $input; do\n        if [[ \"$num\" =~ ^[0-9]+$ ]] && [ \"$num\" -ge 1 ] && [ \"$num\" -le ${#images[@]} ]; then\n            image_id=\"${images[$((num-1))]}\"\n            echo -e \"${RED}æ­£åœ¨å¼ºåˆ¶åˆ é™¤é•œåƒ $num: $image_id${NC}\"\n            docker rmi -f \"$image_id\"\n        else\n            echo -e \"${RED}æ— æ•ˆçš„ç¼–å·: $num${NC}\"\n        fi\n    done\n    \n    echo -e \"${GREEN}æ“ä½œå®Œæˆ${NC}\"\n    read -p \"æŒ‰å›è½¦é”®ç»§ç»­...\"\n}\n\n# æ¸…ç†æœªä½¿ç”¨çš„é•œåƒ\nprune_images() {\n    clear\n    print_line\n    echo -e \"${CYAN}          æ¸…ç†æœªä½¿ç”¨çš„é•œåƒ${NC}\"\n    print_line\n    echo -e \"${YELLOW}æ­£åœ¨æ¸…ç†æœªä½¿ç”¨çš„é•œåƒ...${NC}\\n\"\n    docker image prune -a -f\n    echo -e \"\\n${GREEN}æ¸…ç†å®Œæˆ${NC}\"\n    read -p \"æŒ‰å›è½¦é”®ç»§ç»­...\"\n}\n\n# å®¹å™¨ç®¡ç†ä¸»å¾ªç¯\ncontainer_management() {\n    while true; do\n        show_container_menu\n        read -p \"è¯·é€‰æ‹©æ“ä½œ: \" choice\n        \n        case $choice in\n            1) list_containers; read -p \"æŒ‰å›è½¦é”®ç»§ç»­...\" ;;\n            2) start_containers ;;\n            3) stop_containers ;;\n            4) restart_containers ;;\n            5) remove_containers ;;\n            6) view_container_logs ;;\n            7) break ;;\n            *) echo -e \"${RED}æ— æ•ˆé€‰æ‹©${NC}\"; sleep 1 ;;\n        esac\n    done\n}\n\n# é•œåƒç®¡ç†ä¸»å¾ªç¯\nimage_management() {\n    while true; do\n        show_image_menu\n        read -p \"è¯·é€‰æ‹©æ“ä½œ: \" choice\n        \n        case $choice in\n            1) list_images; read -p \"æŒ‰å›è½¦é”®ç»§ç»­...\" ;;\n            2) remove_images ;;\n            3) prune_images ;;\n            4) break ;;\n            *) echo -e \"${RED}æ— æ•ˆé€‰æ‹©${NC}\"; sleep 1 ;;\n        esac\n    done\n}\n\n# ä¸»ç¨‹åº\nmain() {\n    check_docker\n    \n    while true; do\n        show_main_menu\n        read -p \"è¯·é€‰æ‹©æ“ä½œ: \" choice\n        \n        case $choice in\n            1) container_management ;;\n            2) image_management ;;\n            3) echo -e \"${GREEN}æ„Ÿè°¢ä½¿ç”¨ï¼Œå†è§ï¼${NC}\"; exit 0 ;;\n            *) echo -e \"${RED}æ— æ•ˆé€‰æ‹©${NC}\"; sleep 1 ;;\n        esac\n    done\n}\n\n# è¿è¡Œä¸»ç¨‹åº\nmain",
      "lines": 404,
      "added_time": "2025-12-09T11:10:10Z"
    },
    {
      "id": 9,
      "name": "UFW iptable è®¾ç½®",
      "content": "sudo bash -c 'cat > /usr/local/bin/u.sh << \"EOF\"\n#!/bin/bash\n################################################################################\n# UFW é˜²ç«å¢™ä¸€é”®ç®¡ç†è„šæœ¬ v1.1\n# åŠŸèƒ½: å®‰è£…ã€å¼€å…³ã€TCP/UDPå…¨å¼€ã€è‡ªå®šä¹‰ç«¯å£ã€æŸ¥çœ‹åº•å±‚ Iptables\n################################################################################\n\n# é¢œè‰²å®šä¹‰\nRED=\"\\033[31m\"\nGREEN=\"\\033[32m\"\nYELLOW=\"\\033[33m\"\nPLAIN=\"\\033[0m\"\n\n# æ£€æŸ¥ Root æƒé™\ncheck_root() {\n    if [[ $EUID -ne 0 ]]; then\n        echo -e \"${RED}é”™è¯¯: è¯·ä½¿ç”¨ root æƒé™è¿è¡Œæ­¤è„šæœ¬ï¼${PLAIN}\"\n        echo -e \"è¯·è¿è¡Œ: sudo bash $0\"\n        exit 1\n    fi\n}\n\n# æ£€æŸ¥å¹¶å®‰è£… UFW\ncheck_install() {\n    if ! command -v ufw &> /dev/null; then\n        echo -e \"${YELLOW}æ­£åœ¨å®‰è£… UFW...${PLAIN}\"\n        if command -v apt-get &> /dev/null; then\n            apt-get update -y && apt-get install ufw -y\n        elif command -v yum &> /dev/null; then\n            yum install ufw -y\n        fi\n        echo -e \"${GREEN}UFW å®‰è£…å®Œæˆï¼${PLAIN}\"\n    fi\n}\n\n# è·å–é˜²ç«å¢™çŠ¶æ€\nget_status() {\n    if ufw status | grep -q \"Status: active\"; then\n        echo -e \"${GREEN}è¿è¡Œä¸­ (Active)${PLAIN}\"\n    else\n        echo -e \"${RED}å·²å…³é—­ (Inactive)${PLAIN}\"\n    fi\n}\n\n# å¼€å¯é˜²ç«å¢™ (å¸¦ SSH å®‰å…¨æ£€æµ‹)\nenable_ufw() {\n    echo -e \"${YELLOW}æ­£åœ¨å¼€å¯é˜²ç«å¢™...${PLAIN}\"\n    \n    ufw default deny incoming\n    ufw default allow outgoing\n    \n    local ssh_port=$(grep \"^Port\" /etc/ssh/sshd_config | head -1 | awk \"{print \\$2}\")\n    if [[ -z \"$ssh_port\" ]]; then\n        ssh_port=22\n    fi\n    \n    echo -e \"${YELLOW}æ£€æµ‹åˆ° SSH ç«¯å£ä¸º: $ssh_port${PLAIN}\"\n    read -p \"ç¡®è®¤æ”¾è¡Œ SSH ç«¯å£ $ssh_port? [Y/n]: \" confirm\n    confirm=${confirm:-Y}\n    \n    if [[ $confirm =~ ^[Yy]$ ]]; then\n        ufw allow \"$ssh_port/tcp\"\n        echo -e \"${GREEN}å·²æ”¾è¡Œç«¯å£ $ssh_port (TCP)${PLAIN}\"\n    else\n        read -p \"è¯·è¾“å…¥ä½ è¦æ”¾è¡Œçš„ SSH ç«¯å£: \" custom_ssh\n        ufw allow \"$custom_ssh/tcp\"\n    fi\n\n    echo \"y\" | ufw enable\n    echo -e \"${GREEN}é˜²ç«å¢™å·²å¼€å¯ï¼${PLAIN}\"\n}\n\n# å…³é—­é˜²ç«å¢™\ndisable_ufw() {\n    ufw disable\n    echo -e \"${RED}é˜²ç«å¢™å·²å…³é—­ï¼${PLAIN}\"\n}\n\n# å¼€æ”¾æŒ‡å®šç«¯å£\nallow_port() {\n    echo \"\"\n    read -p \"è¯·è¾“å…¥ç«¯å£å· (ä¾‹å¦‚ 80 æˆ– 8080:9090): \" port\n    echo \"é€‰æ‹©åè®®:\"\n    echo \"1. TCP\"\n    echo \"2. UDP\"\n    echo \"3. TCP + UDP (Both)\"\n    read -p \"è¯·é€‰æ‹© [1-3]: \" proto_choice\n    \n    case $proto_choice in\n        1) ufw allow \"$port/tcp\";;\n        2) ufw allow \"$port/udp\";;\n        3) ufw allow \"$port\";;\n        *) echo -e \"${RED}æ— æ•ˆé€‰æ‹©${PLAIN}\"; return;;\n    esac\n    \n    echo -e \"${GREEN}è§„åˆ™å·²æ·»åŠ ï¼${PLAIN}\"\n    ufw reload\n}\n\n# åˆ é™¤è§„åˆ™\ndelete_rule() {\n    echo \"\"\n    echo -e \"${YELLOW}å½“å‰è§„åˆ™åˆ—è¡¨ (å¸¦ç¼–å·):${PLAIN}\"\n    ufw status numbered\n    echo \"\"\n    read -p \"è¯·è¾“å…¥è¦åˆ é™¤çš„è§„åˆ™ã€ç¼–å·ã€‘ (è¾“å…¥ 0 è¿”å›): \" num\n    \n    if [[ \"$num\" == \"0\" ]]; then\n        return\n    fi\n    \n    echo \"y\" | ufw delete \"$num\"\n    echo -e \"${GREEN}è§„åˆ™å·²åˆ é™¤ï¼${PLAIN}\"\n}\n\n# å¼€æ”¾æ‰€æœ‰ TCP\nallow_all_tcp() {\n    read -p \"âš ï¸  è­¦å‘Šï¼šå…è®¸æ‰€æœ‰ TCP è¿æ¥ï¼Ÿ[y/N]: \" confirm\n    if [[ $confirm =~ ^[Yy]$ ]]; then\n        ufw allow 1:65535/tcp\n        echo -e \"${GREEN}å·²å¼€æ”¾æ‰€æœ‰ TCP ç«¯å£${PLAIN}\"\n    fi\n}\n\n# å¼€æ”¾æ‰€æœ‰ UDP\nallow_all_udp() {\n    read -p \"âš ï¸  è­¦å‘Šï¼šå…è®¸æ‰€æœ‰ UDP è¿æ¥ï¼Ÿ[y/N]: \" confirm\n    if [[ $confirm =~ ^[Yy]$ ]]; then\n        ufw allow 1:65535/udp\n        echo -e \"${GREEN}å·²å¼€æ”¾æ‰€æœ‰ UDP ç«¯å£${PLAIN}\"\n    fi\n}\n\n# é‡ç½®é˜²ç«å¢™\nreset_ufw() {\n    read -p \"âš ï¸  å±é™©ï¼šæ¸…é™¤æ‰€æœ‰è§„åˆ™å¹¶é‡ç½®ï¼Ÿ[y/N]: \" confirm\n    if [[ $confirm =~ ^[Yy]$ ]]; then\n        echo \"y\" | ufw reset\n        echo -e \"${GREEN}å·²é‡ç½®ã€‚${PLAIN}\"\n    fi\n}\n\n# æŸ¥çœ‹ Iptables INPUT é“¾ (æ–°å¢åŠŸèƒ½)\nview_iptables() {\n    echo \"\"\n    echo -e \"${YELLOW}æ­£åœ¨æŸ¥çœ‹ Iptables INPUT é“¾è§„åˆ™...${PLAIN}\"\n    echo \"--------------------------------------------------------\"\n    # ç›´æ¥æ‰§è¡Œç”¨æˆ·è¯·æ±‚çš„å‘½ä»¤\n    iptables -L INPUT -n --line-numbers\n    echo \"--------------------------------------------------------\"\n    echo -e \"${YELLOW}è¯´æ˜: å¦‚æœ UFW å¼€å¯ï¼Œæ­¤å¤„é€šå¸¸æ˜¾ç¤ºè·³è½¬åˆ° ufw-xxx çš„é“¾ã€‚${PLAIN}\"\n    read -p \"æŒ‰å›è½¦ç»§ç»­...\"\n}\n\n# ä¸»èœå•\nshow_menu() {\n    clear\n    echo \"################################################\"\n    echo \"#           UFW é˜²ç«å¢™ç®¡ç†è„šæœ¬ v1.1            #\"\n    echo \"################################################\"\n    echo -e \"å½“å‰çŠ¶æ€: $(get_status)\"\n    echo \"\"\n    echo \" 1. âœ… å¼€å¯é˜²ç«å¢™ (è‡ªåŠ¨æ”¾è¡ŒSSH)\"\n    echo \" 2. â›” å…³é—­é˜²ç«å¢™\"\n    echo \" 3. ğŸ” æŸ¥çœ‹ UFW è§„åˆ™ (ç®€æ˜“)\"\n    echo \"--------------------------------\"\n    echo \" 4. â• å¼€æ”¾ æŒ‡å®šç«¯å£ (TCP/UDP)\"\n    echo \" 5. â– åˆ é™¤ æŒ‡å®šè§„åˆ™ (æŒ‰ç¼–å·)\"\n    echo \"--------------------------------\"\n    echo \" 6. ğŸ”“ å¼€æ”¾ æ‰€æœ‰ TCP (1-65535)\"\n    echo \" 7. ğŸ”“ å¼€æ”¾ æ‰€æœ‰ UDP (1-65535)\"\n    echo \"--------------------------------\"\n    echo \" 8. â™»ï¸  é‡ç½® æ‰€æœ‰è§„åˆ™\"\n    echo \" 9. ğŸ•µï¸  æŸ¥çœ‹ Iptables INPUT è§„åˆ™ (åº•å±‚)\"\n    echo \" 0. é€€å‡º\"\n    echo \"\"\n    read -p \"è¯·é€‰æ‹© [0-9]: \" choice\n    \n    case $choice in\n        1) enable_ufw ;;\n        2) disable_ufw ;;\n        3) ufw status verbose; read -p \"æŒ‰å›è½¦ç»§ç»­...\" ;;\n        4) allow_port ;;\n        5) delete_rule ;;\n        6) allow_all_tcp ;;\n        7) allow_all_udp ;;\n        8) reset_ufw ;;\n        9) view_iptables ;;\n        0) exit 0 ;;\n        *) echo -e \"${RED}æ— æ•ˆé€‰é¡¹${PLAIN}\" ;;\n    esac\n}\n\n# ä¸»ç¨‹åº\ncheck_root\ncheck_install\n\nwhile true; do\n    show_menu\n    echo \"\"\n    read -p \"æŒ‰å›è½¦è¿”å›ä¸»èœå•...\"\ndone\nEOF\nchmod +x /usr/local/bin/u.sh\n/usr/local/bin/u.sh'",
      "lines": 204,
      "added_time": "2025-12-12T09:07:09Z"
    },
    {
      "id": 11,
      "name": "Tailscale ç®¡ç†",
      "content": "#!/bin/bash\n\n# Tailscale ä¸€é”®å·¥å…·ç®±\n# åŠŸèƒ½ï¼šå®‰è£…ã€é…ç½® exit nodeã€å¸è½½ç­‰\n\n# é¢œè‰²å®šä¹‰\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[1;33m'\nBLUE='\\033[0;34m'\nNC='\\033[0m'\n\n# æ£€æŸ¥ root æƒé™\ncheck_root() {\n  if [ \"$EUID\" -ne 0 ]; then\n    echo -e \"${RED}âŒ éœ€è¦ root æƒé™è¿è¡Œæ­¤è„šæœ¬${NC}\"\n    exit 1\n  fi\n}\n\n# èœå•æ˜¾ç¤º\nshow_menu() {\n  clear\n  echo -e \"${BLUE}==========================================\"\n  echo \"      Tailscale ä¸€é”®å·¥å…·ç®±\"\n  echo \"==========================================${NC}\"\n  echo \"\"\n  echo -e \"${YELLOW}[1]${NC} å®‰è£… Tailscale å¹¶å¯åŠ¨\"\n  echo -e \"${YELLOW}[2]${NC} æŸ¥çœ‹ Exit Nodes å¹¶è¿æ¥\"\n  echo -e \"${YELLOW}[3]${NC} æŠŠæœ¬æœºè®¾ç½®ä¸º Exit Node\"\n  echo -e \"${YELLOW}[4]${NC} æŸ¥çœ‹ Tailscale çŠ¶æ€\"\n  echo -e \"${YELLOW}[5]${NC} æ–­å¼€ Exit Node\"\n  echo -e \"${YELLOW}[6]${NC} å¸è½½ Tailscale\"\n  echo -e \"${YELLOW}[7]${NC} é€€å‡º\"\n  echo \"\"\n  echo -e \"${BLUE}=========================================${NC}\"\n}\n\n# 1. å®‰è£… Tailscale\ninstall_tailscale() {\n  echo -e \"${GREEN}ğŸ“¦ å®‰è£… Tailscale...${NC}\"\n  echo \"\"\n  \n  # æ£€æŸ¥æ˜¯å¦å·²å®‰è£…\n  if command -v tailscale &> /dev/null; then\n    echo -e \"${YELLOW}âš ï¸ Tailscale å·²å®‰è£…${NC}\"\n    echo \"\"\n    echo -e \"${BLUE}å¯åŠ¨ Tailscale æœåŠ¡...${NC}\"\n  else\n    echo -e \"${BLUE}ä¸‹è½½å¹¶å®‰è£… Tailscale...${NC}\"\n    curl -fsSL https://tailscale.com/install.sh | sh\n    \n    if [ $? -ne 0 ]; then\n      echo -e \"${RED}âŒ å®‰è£…å¤±è´¥${NC}\"\n      read -p \"æŒ‰ Enter ç»§ç»­...\"\n      return\n    fi\n    echo -e \"${GREEN}âœ“ Tailscale å®‰è£…å®Œæˆ${NC}\"\n  fi\n  \n  echo \"\"\n  echo -e \"${BLUE}ğŸ”„ å¯åŠ¨ Tailscale æœåŠ¡...${NC}\"\n  systemctl start tailscaled\n  systemctl enable tailscaled\n  sleep 2\n  \n  if systemctl is-active --quiet tailscaled; then\n    echo -e \"${GREEN}âœ“ Tailscale æœåŠ¡å·²å¯åŠ¨${NC}\"\n  else\n    echo -e \"${RED}âŒ Tailscale æœåŠ¡å¯åŠ¨å¤±è´¥${NC}\"\n    read -p \"æŒ‰ Enter ç»§ç»­...\"\n    return\n  fi\n  \n  echo \"\"\n  echo -e \"${BLUE}ğŸ” ç™»å½• Tailscale...${NC}\"\n  tailscale up\n  \n  echo \"\"\n  echo -e \"${GREEN}==========================================\"\n  echo \"âœ… Tailscale å®‰è£…å’Œå¯åŠ¨å®Œæˆï¼\"\n  echo \"==========================================${NC}\"\n  echo \"\"\n  \n  read -p \"æŒ‰ Enter ç»§ç»­...\"\n}\n\n# 2. æŸ¥çœ‹å¹¶è¿æ¥ Exit Node\nconnect_exit_node() {\n  echo -e \"${GREEN}ğŸ“¡ æŸ¥çœ‹å¯ç”¨çš„ Exit Nodes...${NC}\"\n  echo \"\"\n  \n  # æŸ¥çœ‹ exit node åˆ—è¡¨\n  tailscale exit-node list\n  \n  echo \"\"\n  echo -e \"${YELLOW}å¯ç”¨ Exit Node åˆ—è¡¨ä¸Šæ–¹æ˜¾ç¤º${NC}\"\n  echo \"\"\n  read -p \"è¾“å…¥ Exit Node çš„ IP æˆ–åç§° (æˆ–æŒ‰ Enter å–æ¶ˆ): \" exit_node\n  \n  if [ -z \"$exit_node\" ]; then\n    echo \"å·²å–æ¶ˆ\"\n    read -p \"æŒ‰ Enter ç»§ç»­...\"\n    return\n  fi\n  \n  echo \"\"\n  echo -e \"${BLUE}ğŸ”„ è¿æ¥åˆ° Exit Node: $exit_node${NC}\"\n  sudo tailscale set --exit-node=\"$exit_node\"\n  \n  if [ $? -ne 0 ]; then\n    echo -e \"${RED}âŒ è¿æ¥å¤±è´¥${NC}\"\n    read -p \"æŒ‰ Enter ç»§ç»­...\"\n    return\n  fi\n  \n  echo -e \"${GREEN}âœ“ Exit Node è¿æ¥æˆåŠŸ${NC}\"\n  \n  echo \"\"\n  echo -e \"${BLUE}ğŸ” éªŒè¯è¿æ¥...${NC}\"\n  sleep 2\n  \n  echo \"\"\n  echo -e \"${YELLOW}æ‚¨çš„å…¬ç½‘ IP:${NC}\"\n  external_ip=$(curl -s http://ipv4.icanhazip.com 2>/dev/null)\n  echo \"$external_ip\"\n  \n  echo \"\"\n  echo -e \"${YELLOW}Tailscale çŠ¶æ€:${NC}\"\n  tailscale status | head -10\n  \n  echo \"\"\n  echo -e \"${GREEN}==========================================\"\n  echo \"âœ… Exit Node å·²è¿æ¥ï¼\"\n  echo \"==========================================${NC}\"\n  echo \"\"\n  \n  read -p \"æŒ‰ Enter ç»§ç»­...\"\n}\n\n# 3. è®¾ç½®æœ¬æœºä¸º Exit Node\nset_as_exit_node() {\n  echo -e \"${GREEN}âš™ï¸ è®¾ç½®æœ¬æœºä¸º Exit Node...${NC}\"\n  echo \"\"\n  \n  echo -e \"${YELLOW}âš ï¸ è­¦å‘Š:${NC}\"\n  echo \"  - è¿™ä¼šè®©å…¶ä»–è®¾å¤‡é€šè¿‡æœ¬æœºè®¿é—®ç½‘ç»œ\"\n  echo \"  - ç¡®ä¿ä½ äº†è§£ Exit Node çš„å®‰å…¨å«ä¹‰\"\n  echo \"\"\n  \n  read -p \"ç¡®è®¤è®¾ç½®ä¸º Exit Node? (yes/no): \" confirm\n  \n  if [ \"$confirm\" != \"yes\" ]; then\n    echo \"å·²å–æ¶ˆ\"\n    read -p \"æŒ‰ Enter ç»§ç»­...\"\n    return\n  fi\n  \n  echo \"\"\n  echo -e \"${BLUE}ğŸ”„ é…ç½®æœ¬æœºä¸º Exit Node...${NC}\"\n  sudo tailscale set --advertise-exit-node\n  \n  if [ $? -ne 0 ]; then\n    echo -e \"${RED}âŒ é…ç½®å¤±è´¥${NC}\"\n    read -p \"æŒ‰ Enter ç»§ç»­...\"\n    return\n  fi\n  \n  echo -e \"${GREEN}âœ“ æœ¬æœºå·²è®¾ç½®ä¸º Exit Node${NC}\"\n  \n  echo \"\"\n  echo -e \"${YELLOW}æç¤º:${NC}\"\n  echo \"  - åœ¨ Tailscale ç®¡ç†ç•Œé¢ä¸­å¯ä»¥æ‰¹å‡†æ­¤ Exit Node\"\n  echo \"  - å…¶ä»–è®¾å¤‡å¯ä»¥è¿æ¥åˆ°æœ¬æœºè¿›è¡Œå‡ºç½‘\"\n  echo \"\"\n  \n  echo -e \"${YELLOW}æ‚¨çš„ Tailscale IP:${NC}\"\n  tailscale ip -4\n  \n  echo \"\"\n  read -p \"æŒ‰ Enter ç»§ç»­...\"\n}\n\n# 4. æŸ¥çœ‹ Tailscale çŠ¶æ€\nshow_tailscale_status() {\n  clear\n  echo -e \"${BLUE}==========================================\"\n  echo \"      Tailscale çŠ¶æ€ä¿¡æ¯\"\n  echo \"==========================================${NC}\"\n  echo \"\"\n  \n  echo -e \"${YELLOW}ğŸ“Š æœåŠ¡çŠ¶æ€:${NC}\"\n  systemctl status tailscaled | grep \"Active\"\n  \n  echo \"\"\n  echo -e \"${YELLOW}ğŸŒ ç½‘ç»œçŠ¶æ€:${NC}\"\n  tailscale status\n  \n  echo \"\"\n  echo -e \"${YELLOW}ğŸ“ Tailscale IP:${NC}\"\n  tailscale ip -4\n  \n  echo \"\"\n  echo -e \"${YELLOW}ğŸ”— Exit Node ä¿¡æ¯:${NC}\"\n  tailscale set --help 2>&1 | grep exit-node || echo \"æ— å½“å‰ Exit Node\"\n  \n  echo \"\"\n  echo -e \"${YELLOW}ğŸ“¡ Exit Node åˆ—è¡¨:${NC}\"\n  tailscale exit-node list\n  \n  echo \"\"\n  echo -e \"${YELLOW}ğŸ” å½“å‰ç”¨æˆ·:${NC}\"\n  tailscale whoami\n  \n  echo \"\"\n  echo -e \"${BLUE}=========================================${NC}\"\n  echo \"\"\n  \n  read -p \"æŒ‰ Enter ç»§ç»­...\"\n}\n\n# 5. æ–­å¼€ Exit Node\ndisconnect_exit_node() {\n  echo -e \"${GREEN}ğŸ”Œ æ–­å¼€ Exit Node...${NC}\"\n  echo \"\"\n  \n  read -p \"ç¡®è®¤æ–­å¼€ Exit Node? (yes/no): \" confirm\n  \n  if [ \"$confirm\" != \"yes\" ]; then\n    echo \"å·²å–æ¶ˆ\"\n    read -p \"æŒ‰ Enter ç»§ç»­...\"\n    return\n  fi\n  \n  echo -e \"${BLUE}ğŸ”„ æ–­å¼€ä¸­...${NC}\"\n  sudo tailscale set --exit-node=\"\"\n  \n  sleep 2\n  \n  echo -e \"${GREEN}âœ“ Exit Node å·²æ–­å¼€${NC}\"\n  echo \"\"\n  echo -e \"${YELLOW}æ‚¨çš„å…¬ç½‘ IP:${NC}\"\n  curl -s http://ipv4.icanhazip.com 2>/dev/null || echo \"æ— æ³•è·å–\"\n  \n  echo \"\"\n  read -p \"æŒ‰ Enter ç»§ç»­...\"\n}\n\n# 6. å¸è½½ Tailscale\nuninstall_tailscale() {\n  echo -e \"${RED}âš ï¸ è­¦å‘Šï¼šè¿™å°†å¸è½½ Tailscaleï¼${NC}\"\n  echo \"\"\n  \n  read -p \"ç¡®è®¤å¸è½½? (yes/no): \" confirm\n  \n  if [ \"$confirm\" != \"yes\" ]; then\n    echo \"å·²å–æ¶ˆ\"\n    read -p \"æŒ‰ Enter ç»§ç»­...\"\n    return\n  fi\n  \n  echo \"\"\n  echo -e \"${BLUE}ğŸ§¹ å¸è½½ Tailscale...${NC}\"\n  \n  # åœæ­¢æœåŠ¡\n  systemctl stop tailscaled 2>/dev/null\n  \n  # å¸è½½\n  apt-get remove -y tailscale 2>/dev/null\n  apt-get purge -y tailscale 2>/dev/null\n  \n  # æ¸…ç†é…ç½®\n  rm -rf /var/lib/tailscale\n  rm -rf /var/cache/tailscale\n  \n  echo -e \"${GREEN}âœ“ Tailscale å·²å¸è½½${NC}\"\n  echo \"\"\n  \n  read -p \"æŒ‰ Enter ç»§ç»­...\"\n}\n\n# ä¸»å¾ªç¯\ncheck_root\n\nwhile true; do\n  show_menu\n  read -p \"è¯·é€‰æ‹© [1-7]: \" choice\n  \n  case $choice in\n    1)\n      install_tailscale\n      ;;\n    2)\n      connect_exit_node\n      ;;\n    3)\n      set_as_exit_node\n      ;;\n    4)\n      show_tailscale_status\n      ;;\n    5)\n      disconnect_exit_node\n      ;;\n    6)\n      uninstall_tailscale\n      ;;\n    7)\n      echo -e \"${GREEN}ğŸ‘‹ è°¢è°¢ä½¿ç”¨ï¼å†è§ï¼${NC}\"\n      exit 0\n      ;;\n    *)\n      echo -e \"${RED}âŒ æ— æ•ˆé€‰æ‹©ï¼Œè¯·é‡è¯•${NC}\"\n      sleep 2\n      ;;\n  esac\ndone",
      "lines": 316,
      "added_time": "2025-12-13T09:23:53Z"
    },
    {
      "id": 13,
      "name": "WIFI  æœ‰çº¿ç®¡ç†",
      "content": "#!/bin/bash\n\n# ç½‘ç»œç®¡ç†å·¥å…·\n# åŠŸèƒ½ï¼šWIFI å’Œæœ‰çº¿ç½‘ç»œå®Œæ•´ç®¡ç†\n\n# é…ç½®æ–‡ä»¶\nCONFIG_FILE=\"/etc/wifi-config.conf\"\nTEMP_FILE=\"/tmp/wifi-temp.conf\"\n\n# é¢œè‰²å®šä¹‰\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[1;33m'\nBLUE='\\033[0;34m'\nCYAN='\\033[0;36m'\nMAGENTA='\\033[0;35m'\nNC='\\033[0m' # No Color\n\n# å¸¸ç”¨DNSæœåŠ¡å™¨\ndeclare -A DNS_SERVERS=(\n    [\"Google\"]=\"8.8.8.8,8.8.4.4\"\n    [\"Cloudflare\"]=\"1.1.1.1,1.0.0.1\"\n    [\"é˜¿é‡Œäº‘\"]=\"223.5.5.5,223.6.6.6\"\n    [\"è…¾è®¯äº‘\"]=\"119.29.29.29,182.254.116.116\"\n    [\"114DNS\"]=\"114.114.114.114,114.114.115.115\"\n    [\"OpenDNS\"]=\"208.67.222.222,208.67.220.220\"\n)\n\n# æ£€æŸ¥æ˜¯å¦ä¸º root\ncheck_root() {\n    if [[ $EUID -ne 0 ]]; then\n        echo -e \"${RED}é”™è¯¯ï¼šæ­¤è„šæœ¬éœ€è¦ root æƒé™è¿è¡Œ${NC}\"\n        echo -e \"${YELLOW}è¯·ä½¿ç”¨: sudo $0${NC}\"\n        exit 1\n    fi\n}\n\n# åˆå§‹åŒ–é…ç½®æ–‡ä»¶\ninit_config() {\n    if [ ! -f \"$CONFIG_FILE\" ]; then\n        touch \"$CONFIG_FILE\"\n        chmod 600 \"$CONFIG_FILE\"\n        echo -e \"${GREEN}âœ“ é…ç½®æ–‡ä»¶å·²åˆ›å»º: $CONFIG_FILE${NC}\"\n    fi\n}\n\n# è·å– WIFI å¯†ç ï¼ˆåŠ å¯†å­˜å‚¨ä¸º base64ï¼‰\nencode_password() {\n    echo -n \"$1\" | base64\n}\n\n# è§£å¯† WIFI å¯†ç \ndecode_password() {\n    echo -n \"$1\" | base64 -d\n}\n\n# è·å–å…¬ç½‘IP\nget_public_ip() {\n    echo -e \"${CYAN}æ­£åœ¨è·å–å…¬ç½‘IP...${NC}\"\n    \n    # IPv4\n    local ipv4=$(timeout 5 curl -4 -s ifconfig.me 2>/dev/null || timeout 5 curl -4 -s icanhazip.com 2>/dev/null || echo \"è·å–å¤±è´¥\")\n    \n    # IPv6\n    local ipv6=$(timeout 5 curl -6 -s ifconfig.me 2>/dev/null || timeout 5 curl -6 -s icanhazip.com 2>/dev/null || echo \"ä¸æ”¯æŒæˆ–è·å–å¤±è´¥\")\n    \n    echo -e \"${GREEN}å…¬ç½‘ IPv4:${NC} $ipv4\"\n    echo -e \"${GREEN}å…¬ç½‘ IPv6:${NC} $ipv6\"\n    echo \"\"\n}\n\n# æ˜¾ç¤ºå½“å‰ç½‘ç»œçŠ¶æ€ï¼ˆç®€åŒ–ç‰ˆï¼‰\nshow_current_status() {\n    # æ£€æŸ¥å½“å‰æ´»åŠ¨è¿æ¥\n    local active_wifi=$(nmcli -t -f active,ssid dev wifi | grep \"^yes\" | cut -d: -f2)\n    local active_ethernet=$(nmcli -t -f DEVICE,TYPE,STATE device | grep \"ethernet:connected\" | cut -d: -f1)\n    \n    if [ -n \"$active_wifi\" ]; then\n        echo -e \"${GREEN}å½“å‰è¿æ¥: WIFI ($active_wifi)${NC}\"\n    elif [ -n \"$active_ethernet\" ]; then\n        echo -e \"${GREEN}å½“å‰è¿æ¥: æœ‰çº¿ç½‘ç»œ ($active_ethernet)${NC}\"\n    else\n        echo -e \"${YELLOW}å½“å‰çŠ¶æ€: æœªè¿æ¥ç½‘ç»œ${NC}\"\n    fi\n}\n\n# ==================== WIFI ç®¡ç†åŠŸèƒ½ ====================\n\n# æ·»åŠ /ç¼–è¾‘ WIFI é…ç½®ï¼ˆä¼˜åŒ–ç‰ˆï¼šä»æ‰«æåˆ—è¡¨é€‰æ‹©ï¼‰\nadd_wifi() {\n    clear\n    echo -e \"${BLUE}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}\"\n    echo -e \"${BLUE}â•‘         æ·»åŠ  WIFI é…ç½®                  â•‘${NC}\"\n    echo -e \"${BLUE}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}\"\n    echo \"\"\n    \n    # è‡ªåŠ¨æ‰«æ WIFI\n    echo -e \"${CYAN}æ­£åœ¨æ‰«æé™„è¿‘çš„ WIFI...ï¼ˆçº¦ 5 ç§’ï¼‰${NC}\"\n    \n    local wifi_device=$(nmcli device | grep wifi | awk '{print $1}')\n    \n    if [ -z \"$wifi_device\" ]; then\n        echo -e \"${RED}âœ— æœªæ‰¾åˆ° WIFI è®¾å¤‡${NC}\"\n        return 1\n    fi\n    \n    # æ‰«æ WIFI\n    nmcli dev wifi rescan 2>/dev/null\n    \n    # æ˜¾ç¤ºæ‰«æè¿›åº¦\n    for i in {1..5}; do\n        echo -ne \"\\ræ‰«æè¿›åº¦: $i/5 ç§’\"\n        sleep 1\n    done\n    echo -ne \"\\ræ‰«æå®Œæˆï¼                \\n\"\n    echo \"\"\n    \n    # æ˜¾ç¤ºæ‰«æç»“æœ\n    echo -e \"${GREEN}æ‰«æåˆ°çš„ WIFI åˆ—è¡¨ï¼š${NC}\"\n    echo \"\"\n    \n    # ä¿å­˜ WIFI åˆ—è¡¨åˆ°ä¸´æ—¶æ•°ç»„\n    local wifi_list=()\n    while IFS= read -r line; do\n        wifi_list+=(\"$line\")\n    done < <(nmcli -t -f SSID,SIGNAL,SECURITY dev wifi list | grep -v \"^--\" | grep -v \"^$\")\n    \n    if [ ${#wifi_list[@]} -eq 0 ]; then\n        echo -e \"${RED}âœ— æœªæ‰«æåˆ°ä»»ä½• WIFI${NC}\"\n        return 1\n    fi\n    \n    # æ˜¾ç¤º WIFI åˆ—è¡¨\n    echo -e \"${CYAN}ç¼–å·  SSID                              ä¿¡å·    å®‰å…¨${NC}\"\n    echo \"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\"\n    \n    local index=1\n    for wifi in \"${wifi_list[@]}\"; do\n        IFS=':' read -r ssid signal security <<< \"$wifi\"\n        printf \"${GREEN}%-4s${NC}  %-35s %-6s  %s\\n\" \"$index\" \"$ssid\" \"$signal\" \"$security\"\n        ((index++))\n    done\n    \n    echo \"\"\n    echo -e \"${YELLOW}æç¤º: è¾“å…¥ 0 å¯æ‰‹åŠ¨è¾“å…¥ SSIDï¼ˆé€‚ç”¨äºéšè—ç½‘ç»œï¼‰${NC}\"\n    echo \"\"\n    \n    # ç”¨æˆ·é€‰æ‹©\n    read -p \"è¯·é€‰æ‹©è¦æ·»åŠ çš„ WIFI (è¾“å…¥ç¼–å·): \" choice\n    \n    local selected_ssid=\"\"\n    \n    if [ \"$choice\" = \"0\" ]; then\n        # æ‰‹åŠ¨è¾“å…¥æ¨¡å¼\n        read -p \"è¯·è¾“å…¥ WIFI åç§° (SSID): \" selected_ssid\n        if [ -z \"$selected_ssid\" ]; then\n            echo -e \"${RED}âœ— WIFI åç§°ä¸èƒ½ä¸ºç©º${NC}\"\n            return 1\n        fi\n    elif [[ \"$choice\" =~ ^[0-9]+$ ]] && [ \"$choice\" -ge 1 ] && [ \"$choice\" -le ${#wifi_list[@]} ]; then\n        # ä»åˆ—è¡¨é€‰æ‹©\n        local selected_wifi=\"${wifi_list[$((choice-1))]}\"\n        selected_ssid=$(echo \"$selected_wifi\" | cut -d: -f1)\n    else\n        echo -e \"${RED}âœ— æ— æ•ˆçš„é€‰æ‹©${NC}\"\n        return 1\n    fi\n    \n    echo \"\"\n    echo -e \"${CYAN}å·²é€‰æ‹© WIFI: $selected_ssid${NC}\"\n    echo \"\"\n    \n    # è¾“å…¥å¯†ç \n    read -sp \"è¯·è¾“å…¥ WIFI å¯†ç : \" password\n    echo \"\"\n    read -sp \"è¯·é‡æ–°è¾“å…¥å¯†ç ç¡®è®¤: \" password_confirm\n    echo \"\"\n    \n    if [ \"$password\" != \"$password_confirm\" ]; then\n        echo -e \"${RED}âœ— ä¸¤æ¬¡å¯†ç ä¸ä¸€è‡´${NC}\"\n        return 1\n    fi\n    \n    # æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨\n    if grep -q \"^$selected_ssid|\" \"$CONFIG_FILE\"; then\n        echo -e \"${YELLOW}âš  WIFI å·²å­˜åœ¨ï¼Œå°†è¿›è¡Œè¦†ç›–${NC}\"\n        sed -i \"/^$selected_ssid|/d\" \"$CONFIG_FILE\"\n    fi\n    \n    # åŠ å¯†å¯†ç å¹¶ä¿å­˜\n    encoded_password=$(encode_password \"$password\")\n    echo \"$selected_ssid|$encoded_password\" >> \"$CONFIG_FILE\"\n    \n    echo -e \"${GREEN}âœ“ WIFI é…ç½®å·²ä¿å­˜${NC}\"\n    return 0\n}\n\n# æ˜¾ç¤ºå·²ä¿å­˜çš„ WIFI åˆ—è¡¨\nlist_wifi() {\n    if [ ! -s \"$CONFIG_FILE\" ]; then\n        echo -e \"${YELLOW}âš  æ²¡æœ‰å·²ä¿å­˜çš„ WIFI é…ç½®${NC}\"\n        return 1\n    fi\n    \n    echo -e \"${CYAN}å·²ä¿å­˜çš„ WIFI åˆ—è¡¨ï¼š${NC}\"\n    local count=0\n    while IFS='|' read -r ssid password; do\n        count=$((count + 1))\n        echo -e \"  ${GREEN}$count${NC}. $ssid\"\n    done < \"$CONFIG_FILE\"\n    \n    return 0\n}\n\n# è¿æ¥å·²ä¿å­˜çš„ WIFI\nconnect_saved_wifi() {\n    clear\n    echo -e \"${BLUE}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}\"\n    echo -e \"${BLUE}â•‘         è¿æ¥å·²ä¿å­˜çš„ WIFI               â•‘${NC}\"\n    echo -e \"${BLUE}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}\"\n    echo \"\"\n    \n    if ! list_wifi; then\n        return 1\n    fi\n    \n    echo \"\"\n    read -p \"è¯·é€‰æ‹©è¦è¿æ¥çš„ WIFI (è¾“å…¥åºå·): \" choice\n    \n    # è·å–é€‰ä¸­çš„ WIFI ä¿¡æ¯\n    local count=0\n    local selected_ssid=\"\"\n    local selected_password=\"\"\n    \n    while IFS='|' read -r ssid password; do\n        count=$((count + 1))\n        if [ \"$count\" -eq \"$choice\" ]; then\n            selected_ssid=\"$ssid\"\n            selected_password=$(decode_password \"$password\")\n            break\n        fi\n    done < \"$CONFIG_FILE\"\n    \n    if [ -z \"$selected_ssid\" ]; then\n        echo -e \"${RED}âœ— æ— æ•ˆçš„é€‰æ‹©${NC}\"\n        return 1\n    fi\n    \n    echo -e \"${CYAN}æ­£åœ¨è¿æ¥åˆ°: $selected_ssid${NC}\"\n    \n    # ä½¿ç”¨ nmcli è¿æ¥ WIFI\n    nmcli dev wifi connect \"$selected_ssid\" password \"$selected_password\"\n    \n    if [ $? -eq 0 ]; then\n        echo -e \"${GREEN}âœ“ å·²è¿æ¥åˆ°: $selected_ssid${NC}\"\n        return 0\n    else\n        echo -e \"${RED}âœ— è¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥å¯†ç æˆ–ä¿¡å·${NC}\"\n        return 1\n    fi\n}\n\n# æ‰«æé™„è¿‘ WIFIï¼ˆä»…æŸ¥çœ‹ï¼‰\nscan_wifi() {\n    clear\n    echo -e \"${BLUE}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}\"\n    echo -e \"${BLUE}â•‘         æ‰«æé™„è¿‘çš„ WIFI                 â•‘${NC}\"\n    echo -e \"${BLUE}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}\"\n    echo \"\"\n    \n    echo -e \"${CYAN}æ­£åœ¨æ‰«ææ‰€æœ‰ WIFI ä¿¡å·...ï¼ˆçº¦ 5 ç§’ï¼‰${NC}\"\n    \n    local wifi_device=$(nmcli device | grep wifi | awk '{print $1}')\n    \n    if [ -z \"$wifi_device\" ]; then\n        echo -e \"${RED}âœ— æœªæ‰¾åˆ° WIFI è®¾å¤‡${NC}\"\n        return 1\n    fi\n    \n    nmcli dev wifi rescan 2>/dev/null\n    \n    for i in {1..5}; do\n        echo -ne \"\\ræ‰«æè¿›åº¦: $i/5 ç§’\"\n        sleep 1\n    done\n    echo -ne \"\\ræ‰«æå®Œæˆï¼                \\n\"\n    echo \"\"\n    \n    echo -e \"${GREEN}æ‰«æç»“æœï¼š${NC}\"\n    echo \"\"\n    nmcli dev wifi list 2>/dev/null | head -50\n    \n    echo \"\"\n    local total=$(nmcli dev wifi list 2>/dev/null | wc -l)\n    echo -e \"${YELLOW}æ€»å…±æ‰¾åˆ° $((total-1)) ä¸ª WIFI ç½‘ç»œ${NC}\"\n}\n\n# åˆ é™¤ WIFI é…ç½®\ndelete_wifi() {\n    clear\n    echo -e \"${BLUE}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}\"\n    echo -e \"${BLUE}â•‘         åˆ é™¤ WIFI é…ç½®                  â•‘${NC}\"\n    echo -e \"${BLUE}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}\"\n    echo \"\"\n    \n    if ! list_wifi; then\n        return 1\n    fi\n    \n    echo \"\"\n    read -p \"è¯·é€‰æ‹©è¦åˆ é™¤çš„ WIFI (è¾“å…¥åºå·): \" choice\n    \n    local count=0\n    local selected_ssid=\"\"\n    \n    while IFS='|' read -r ssid password; do\n        count=$((count + 1))\n        if [ \"$count\" -eq \"$choice\" ]; then\n            selected_ssid=\"$ssid\"\n            break\n        fi\n    done < \"$CONFIG_FILE\"\n    \n    if [ -z \"$selected_ssid\" ]; then\n        echo -e \"${RED}âœ— æ— æ•ˆçš„é€‰æ‹©${NC}\"\n        return 1\n    fi\n    \n    read -p \"ç¡®è®¤åˆ é™¤ '$selected_ssid' å—? (y/n): \" confirm\n    if [ \"$confirm\" != \"y\" ] && [ \"$confirm\" != \"Y\" ]; then\n        echo -e \"${YELLOW}âš  å·²å–æ¶ˆ${NC}\"\n        return 0\n    fi\n    \n    sed -i \"/^${selected_ssid}|/d\" \"$CONFIG_FILE\"\n    echo -e \"${GREEN}âœ“ WIFI é…ç½®å·²åˆ é™¤${NC}\"\n}\n\n# WIFI ç®¡ç†èœå•\nwifi_menu() {\n    while true; do\n        clear\n        echo -e \"${BLUE}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}\"\n        echo -e \"${BLUE}â•‘           WIFI ç®¡ç†èœå•                 â•‘${NC}\"\n        echo -e \"${BLUE}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}\"\n        echo \"\"\n        show_current_status\n        echo \"\"\n        echo -e \"${YELLOW}è¯·é€‰æ‹©æ“ä½œ:${NC}\"\n        echo -e \"  ${GREEN}1${NC}) æ·»åŠ /ç¼–è¾‘ WIFI é…ç½®\"\n        echo -e \"  ${GREEN}2${NC}) è¿æ¥å·²ä¿å­˜çš„ WIFI\"\n        echo -e \"  ${GREEN}3${NC}) æ‰«æé™„è¿‘çš„ WIFI\"\n        echo -e \"  ${GREEN}4${NC}) åˆ é™¤ WIFI é…ç½®\"\n        echo -e \"  ${GREEN}0${NC}) è¿”å›ä¸»èœå•\"\n        echo \"\"\n        read -p \"è¯·è¾“å…¥é€‰é¡¹: \" choice\n        \n        case $choice in\n            1) add_wifi ;;\n            2) connect_saved_wifi ;;\n            3) scan_wifi ;;\n            4) delete_wifi ;;\n            0) return 0 ;;\n            *) echo -e \"${RED}æ— æ•ˆçš„é€‰é¡¹${NC}\" ;;\n        esac\n        \n        read -p \"æŒ‰ Enter ç»§ç»­...\"\n    done\n}\n\n# ==================== æœ‰çº¿ç½‘ç»œç®¡ç†åŠŸèƒ½ ====================\n\n# æŸ¥çœ‹æœ‰çº¿ç½‘ç»œçŠ¶æ€\nshow_ethernet_status() {\n    clear\n    echo -e \"${BLUE}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}\"\n    echo -e \"${BLUE}â•‘         æœ‰çº¿ç½‘ç»œçŠ¶æ€                    â•‘${NC}\"\n    echo -e \"${BLUE}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}\"\n    echo \"\"\n    \n    # æ˜¾ç¤ºæ‰€æœ‰ä»¥å¤ªç½‘è®¾å¤‡\n    echo -e \"${CYAN}=== æœ‰çº¿ç½‘ç»œæ¥å£ ===${NC}\"\n    nmcli device | grep ethernet | awk '{printf \"%-15s %-12s %-15s %s\\n\", $1, $2, $3, $4}'\n    echo \"\"\n    \n    # æ˜¾ç¤ºè™šæ‹Ÿç½‘ç»œæ¥å£\n    echo -e \"${CYAN}=== è™šæ‹Ÿç½‘ç»œæ¥å£ ===${NC}\"\n    ip link show | grep -E \"docker|veth|br-|virbr\" | awk '{print $2}' | sed 's/:$//' | while read iface; do\n        echo \"  â€¢ $iface\"\n    done\n    echo \"\"\n    \n    # æ˜¾ç¤ºè¯¦ç»†çš„æ´»åŠ¨è¿æ¥\n    echo -e \"${CYAN}=== æ´»åŠ¨çš„æœ‰çº¿è¿æ¥è¯¦æƒ… ===${NC}\"\n    nmcli connection show --active | grep ethernet | while read line; do\n        local conn_name=$(echo \"$line\" | awk '{print $1}')\n        echo -e \"${GREEN}è¿æ¥åç§°:${NC} $conn_name\"\n        \n        nmcli connection show \"$conn_name\" 2>/dev/null | grep -E \"IP4.ADDRESS|IP4.GATEWAY|IP4.DNS|IP6.ADDRESS|GENERAL.HWADDR\" | while read detail; do\n            echo \"  $detail\"\n        done\n        echo \"\"\n    done\n    \n    # æ˜¾ç¤ºå…¬ç½‘IP\n    echo -e \"${CYAN}=== å…¬ç½‘ IP åœ°å€ ===${NC}\"\n    get_public_ip\n}\n\n# é…ç½®æœ‰çº¿ç½‘ç»œDNS\nconfigure_ethernet_dns() {\n    clear\n    echo -e \"${BLUE}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}\"\n    echo -e \"${BLUE}â•‘         é…ç½®æœ‰çº¿ç½‘ç»œ DNS                â•‘${NC}\"\n    echo -e \"${BLUE}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}\"\n    echo \"\"\n    \n    # è·å–æœ‰çº¿è¿æ¥åˆ—è¡¨\n    local eth_connections=($(nmcli -t -f NAME,TYPE connection show | grep ethernet | cut -d: -f1))\n    \n    if [ ${#eth_connections[@]} -eq 0 ]; then\n        echo -e \"${RED}âœ— æœªæ‰¾åˆ°æœ‰çº¿ç½‘ç»œè¿æ¥${NC}\"\n        return 1\n    fi\n    \n    # æ˜¾ç¤ºè¿æ¥åˆ—è¡¨\n    echo -e \"${CYAN}æœ‰çº¿ç½‘ç»œè¿æ¥åˆ—è¡¨ï¼š${NC}\"\n    for i in \"${!eth_connections[@]}\"; do\n        echo -e \"  ${GREEN}$((i+1))${NC}) ${eth_connections[$i]}\"\n    done\n    echo \"\"\n    \n    read -p \"è¯·é€‰æ‹©è¦é…ç½®çš„è¿æ¥ (è¾“å…¥åºå·): \" conn_choice\n    \n    if [[ ! \"$conn_choice\" =~ ^[0-9]+$ ]] || [ \"$conn_choice\" -lt 1 ] || [ \"$conn_choice\" -gt ${#eth_connections[@]} ]; then\n        echo -e \"${RED}âœ— æ— æ•ˆçš„é€‰æ‹©${NC}\"\n        return 1\n    fi\n    \n    local selected_conn=\"${eth_connections[$((conn_choice-1))]}\"\n    echo -e \"${CYAN}å·²é€‰æ‹©è¿æ¥: $selected_conn${NC}\"\n    echo \"\"\n    \n    # æ˜¾ç¤ºé¢„è®¾DNS\n    echo -e \"${YELLOW}è¯·é€‰æ‹© DNS æœåŠ¡å™¨ï¼š${NC}\"\n    local dns_index=1\n    local dns_keys=()\n    \n    for dns_name in \"${!DNS_SERVERS[@]}\"; do\n        dns_keys+=(\"$dns_name\")\n        echo -e \"  ${GREEN}$dns_index${NC}) $dns_name (${DNS_SERVERS[$dns_name]})\"\n        ((dns_index++))\n    done\n    echo -e \"  ${GREEN}0${NC}) æ‰‹åŠ¨è¾“å…¥ DNS\"\n    echo \"\"\n    \n    read -p \"è¯·é€‰æ‹© (è¾“å…¥åºå·): \" dns_choice\n    \n    local dns_servers=\"\"\n    \n    if [ \"$dns_choice\" = \"0\" ]; then\n        read -p \"è¯·è¾“å…¥ DNS æœåŠ¡å™¨ (å¤šä¸ªç”¨é€—å·åˆ†éš”): \" dns_servers\n    elif [[ \"$dns_choice\" =~ ^[0-9]+$ ]] && [ \"$dns_choice\" -ge 1 ] && [ \"$dns_choice\" -le ${#dns_keys[@]} ]; then\n        local selected_dns_name=\"${dns_keys[$((dns_choice-1))]}\"\n        dns_servers=\"${DNS_SERVERS[$selected_dns_name]}\"\n    else\n        echo -e \"${RED}âœ— æ— æ•ˆçš„é€‰æ‹©${NC}\"\n        return 1\n    fi\n    \n    echo \"\"\n    echo -e \"${CYAN}æ­£åœ¨è®¾ç½® DNS: $dns_servers${NC}\"\n    \n    # è®¾ç½®DNS\n    nmcli connection modify \"$selected_conn\" ipv4.dns \"$dns_servers\"\n    nmcli connection modify \"$selected_conn\" ipv4.ignore-auto-dns yes\n    nmcli connection up \"$selected_conn\"\n    \n    if [ $? -eq 0 ]; then\n        echo -e \"${GREEN}âœ“ DNS è®¾ç½®æˆåŠŸ${NC}\"\n    else\n        echo -e \"${RED}âœ— DNS è®¾ç½®å¤±è´¥${NC}\"\n    fi\n}\n\n# é…ç½®æœ‰çº¿ç½‘ç»œç½‘å…³å’ŒIP\nconfigure_ethernet_ip() {\n    clear\n    echo -e \"${BLUE}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}\"\n    echo -e \"${BLUE}â•‘         é…ç½®æœ‰çº¿ç½‘ç»œ IP/ç½‘å…³            â•‘${NC}\"\n    echo -e \"${BLUE}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}\"\n    echo \"\"\n    \n    # è·å–æœ‰çº¿è¿æ¥åˆ—è¡¨\n    local eth_connections=($(nmcli -t -f NAME,TYPE connection show | grep ethernet | cut -d: -f1))\n    \n    if [ ${#eth_connections[@]} -eq 0 ]; then\n        echo -e \"${RED}âœ— æœªæ‰¾åˆ°æœ‰çº¿ç½‘ç»œè¿æ¥${NC}\"\n        return 1\n    fi\n    \n    # æ˜¾ç¤ºè¿æ¥åˆ—è¡¨\n    echo -e \"${CYAN}æœ‰çº¿ç½‘ç»œè¿æ¥åˆ—è¡¨ï¼š${NC}\"\n    for i in \"${!eth_connections[@]}\"; do\n        echo -e \"  ${GREEN}$((i+1))${NC}) ${eth_connections[$i]}\"\n    done\n    echo \"\"\n    \n    read -p \"è¯·é€‰æ‹©è¦é…ç½®çš„è¿æ¥ (è¾“å…¥åºå·): \" conn_choice\n    \n    if [[ ! \"$conn_choice\" =~ ^[0-9]+$ ]] || [ \"$conn_choice\" -lt 1 ] || [ \"$conn_choice\" -gt ${#eth_connections[@]} ]; then\n        echo -e \"${RED}âœ— æ— æ•ˆçš„é€‰æ‹©${NC}\"\n        return 1\n    fi\n    \n    local selected_conn=\"${eth_connections[$((conn_choice-1))]}\"\n    echo -e \"${CYAN}å·²é€‰æ‹©è¿æ¥: $selected_conn${NC}\"\n    echo \"\"\n    \n    # é€‰æ‹©é…ç½®æ¨¡å¼\n    echo -e \"${YELLOW}è¯·é€‰æ‹©é…ç½®æ¨¡å¼ï¼š${NC}\"\n    echo -e \"  ${GREEN}1${NC}) DHCP (è‡ªåŠ¨è·å–)\"\n    echo -e \"  ${GREEN}2${NC}) é™æ€ IP\"\n    echo \"\"\n    read -p \"è¯·é€‰æ‹©: \" mode_choice\n    \n    if [ \"$mode_choice\" = \"1\" ]; then\n        # DHCP æ¨¡å¼\n        echo -e \"${CYAN}æ­£åœ¨è®¾ç½®ä¸º DHCP æ¨¡å¼...${NC}\"\n        nmcli connection modify \"$selected_conn\" ipv4.method auto\n        nmcli connection up \"$selected_conn\"\n        echo -e \"${GREEN}âœ“ å·²åˆ‡æ¢åˆ° DHCP æ¨¡å¼${NC}\"\n        \n    elif [ \"$mode_choice\" = \"2\" ]; then\n        # é™æ€ IP æ¨¡å¼\n        echo \"\"\n        read -p \"è¯·è¾“å…¥ IP åœ°å€ (å¦‚: 192.168.1.100): \" ip_addr\n        read -p \"è¯·è¾“å…¥å­ç½‘æ©ç ä½æ•° (å¦‚: 24): \" prefix\n        read -p \"è¯·è¾“å…¥ç½‘å…³åœ°å€ (å¦‚: 192.168.1.1): \" gateway\n        \n        if [ -z \"$ip_addr\" ] || [ -z \"$prefix\" ] || [ -z \"$gateway\" ]; then\n            echo -e \"${RED}âœ— ä¿¡æ¯ä¸å®Œæ•´${NC}\"\n            return 1\n        fi\n        \n        echo \"\"\n        echo -e \"${CYAN}æ­£åœ¨è®¾ç½®é™æ€ IP...${NC}\"\n        nmcli connection modify \"$selected_conn\" ipv4.method manual\n        nmcli connection modify \"$selected_conn\" ipv4.addresses \"$ip_addr/$prefix\"\n        nmcli connection modify \"$selected_conn\" ipv4.gateway \"$gateway\"\n        nmcli connection up \"$selected_conn\"\n        \n        echo -e \"${GREEN}âœ“ é™æ€ IP è®¾ç½®æˆåŠŸ${NC}\"\n        echo -e \"  IP: $ip_addr/$prefix\"\n        echo -e \"  ç½‘å…³: $gateway\"\n    else\n        echo -e \"${RED}âœ— æ— æ•ˆçš„é€‰æ‹©${NC}\"\n        return 1\n    fi\n}\n\n# å¯ç”¨/ç¦ç”¨æœ‰çº¿ç½‘ç»œ\ntoggle_ethernet() {\n    clear\n    echo -e \"${BLUE}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}\"\n    echo -e \"${BLUE}â•‘         å¯ç”¨/ç¦ç”¨æœ‰çº¿ç½‘ç»œ               â•‘${NC}\"\n    echo -e \"${BLUE}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}\"\n    echo \"\"\n    \n    # è·å–æ‰€æœ‰ä»¥å¤ªç½‘è®¾å¤‡\n    echo -e \"${CYAN}æœ‰çº¿ç½‘ç»œè®¾å¤‡åˆ—è¡¨ï¼š${NC}\"\n    local eth_devices=($(nmcli -t -f DEVICE,TYPE device | grep ethernet | cut -d: -f1))\n    \n    if [ ${#eth_devices[@]} -eq 0 ]; then\n        echo -e \"${RED}âœ— æœªæ‰¾åˆ°æœ‰çº¿ç½‘ç»œè®¾å¤‡${NC}\"\n        return 1\n    fi\n    \n    for i in \"${!eth_devices[@]}\"; do\n        local device=\"${eth_devices[$i]}\"\n        local state=$(nmcli -t -f DEVICE,STATE device | grep \"^$device:\" | cut -d: -f2)\n        echo -e \"  ${GREEN}$((i+1))${NC}) $device [$state]\"\n    done\n    echo \"\"\n    \n    read -p \"è¯·é€‰æ‹©è®¾å¤‡ (è¾“å…¥åºå·): \" dev_choice\n    \n    if [[ ! \"$dev_choice\" =~ ^[0-9]+$ ]] || [ \"$dev_choice\" -lt 1 ] || [ \"$dev_choice\" -gt ${#eth_devices[@]} ]; then\n        echo -e \"${RED}âœ— æ— æ•ˆçš„é€‰æ‹©${NC}\"\n        return 1\n    fi\n    \n    local selected_device=\"${eth_devices[$((dev_choice-1))]}\"\n    local current_state=$(nmcli -t -f DEVICE,STATE device | grep \"^$selected_device:\" | cut -d: -f2)\n    \n    echo \"\"\n    echo -e \"${YELLOW}è¯·é€‰æ‹©æ“ä½œï¼š${NC}\"\n    echo -e \"  ${GREEN}1${NC}) å¯ç”¨\"\n    echo -e \"  ${GREEN}2${NC}) ç¦ç”¨\"\n    echo \"\"\n    read -p \"è¯·é€‰æ‹©: \" action\n    \n    if [ \"$action\" = \"1\" ]; then\n        nmcli device connect \"$selected_device\"\n        echo -e \"${GREEN}âœ“ å·²å¯ç”¨ $selected_device${NC}\"\n    elif [ \"$action\" = \"2\" ]; then\n        nmcli device disconnect \"$selected_device\"\n        echo -e \"${GREEN}âœ“ å·²ç¦ç”¨ $selected_device${NC}\"\n    else\n        echo -e \"${RED}âœ— æ— æ•ˆçš„é€‰æ‹©${NC}\"\n    fi\n}\n\n# æœ‰çº¿ç½‘ç»œç®¡ç†èœå•\nethernet_menu() {\n    while true; do\n        clear\n        echo -e \"${BLUE}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}\"\n        echo -e \"${BLUE}â•‘         æœ‰çº¿ç½‘ç»œç®¡ç†èœå•                â•‘${NC}\"\n        echo -e \"${BLUE}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}\"\n        echo \"\"\n        show_current_status\n        echo \"\"\n        echo -e \"${YELLOW}è¯·é€‰æ‹©æ“ä½œ:${NC}\"\n        echo -e \"  ${GREEN}1${NC}) æŸ¥çœ‹æœ‰çº¿ç½‘ç»œçŠ¶æ€\"\n        echo -e \"  ${GREEN}2${NC}) é…ç½® DNS æœåŠ¡å™¨\"\n        echo -e \"  ${GREEN}3${NC}) é…ç½® IP åœ°å€å’Œç½‘å…³\"\n        echo -e \"  ${GREEN}4${NC}) å¯ç”¨/ç¦ç”¨æœ‰çº¿ç½‘ç»œ\"\n        echo -e \"  ${GREEN}0${NC}) è¿”å›ä¸»èœå•\"\n        echo \"\"\n        read -p \"è¯·è¾“å…¥é€‰é¡¹: \" choice\n        \n        case $choice in\n            1) show_ethernet_status ;;\n            2) configure_ethernet_dns ;;\n            3) configure_ethernet_ip ;;\n            4) toggle_ethernet ;;\n            0) return 0 ;;\n            *) echo -e \"${RED}æ— æ•ˆçš„é€‰é¡¹${NC}\" ;;\n        esac\n        \n        read -p \"æŒ‰ Enter ç»§ç»­...\"\n    done\n}\n\n# ==================== ç½‘ç»œåˆ‡æ¢åŠŸèƒ½ ====================\n\n# åˆ‡æ¢åˆ°æœ‰çº¿ç½‘ç»œ\nswitch_to_ethernet() {\n    clear\n    echo -e \"${BLUE}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}\"\n    echo -e \"${BLUE}â•‘         åˆ‡æ¢åˆ°æœ‰çº¿ç½‘ç»œ                  â•‘${NC}\"\n    echo -e \"${BLUE}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}\"\n    echo \"\"\n    \n    echo -e \"${YELLOW}è­¦å‘Š: æ­¤æ“ä½œå°†ç¦ç”¨æ‰€æœ‰ WIFI è¿æ¥${NC}\"\n    read -p \"ç¡®è®¤åˆ‡æ¢åˆ°æœ‰çº¿ç½‘ç»œå—? (y/n): \" confirm\n    \n    if [ \"$confirm\" != \"y\" ] && [ \"$confirm\" != \"Y\" ]; then\n        echo -e \"${YELLOW}âš  å·²å–æ¶ˆ${NC}\"\n        return 0\n    fi\n    \n    echo \"\"\n    echo -e \"${CYAN}æ­£åœ¨ç¦ç”¨ WIFI...${NC}\"\n    nmcli radio wifi off\n    \n    sleep 1\n    \n    echo -e \"${CYAN}æ­£åœ¨å¯ç”¨æœ‰çº¿ç½‘ç»œ...${NC}\"\n    local eth_devices=($(nmcli -t -f DEVICE,TYPE device | grep ethernet | cut -d: -f1))\n    \n    for device in \"${eth_devices[@]}\"; do\n        nmcli device connect \"$device\" 2>/dev/null\n    done\n    \n    sleep 1\n    \n    echo -e \"${GREEN}âœ“ å·²åˆ‡æ¢åˆ°æœ‰çº¿ç½‘ç»œ${NC}\"\n    echo \"\"\n    \n    # æ˜¾ç¤ºå½“å‰è¿æ¥çŠ¶æ€\n    echo -e \"${CYAN}å½“å‰ç½‘ç»œçŠ¶æ€ï¼š${NC}\"\n    nmcli device | grep -E \"ethernet|wifi\"\n}\n\n# åˆ‡æ¢åˆ° WIFI ç½‘ç»œ\nswitch_to_wifi() {\n    clear\n    echo -e \"${BLUE}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}\"\n    echo -e \"${BLUE}â•‘         åˆ‡æ¢åˆ° WIFI ç½‘ç»œ                â•‘${NC}\"\n    echo -e \"${BLUE}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}\"\n    echo \"\"\n    \n    echo -e \"${YELLOW}è­¦å‘Š: æ­¤æ“ä½œå°†ç¦ç”¨æ‰€æœ‰æœ‰çº¿ç½‘ç»œè¿æ¥${NC}\"\n    read -p \"ç¡®è®¤åˆ‡æ¢åˆ° WIFI ç½‘ç»œå—? (y/n): \" confirm\n    \n    if [ \"$confirm\" != \"y\" ] && [ \"$confirm\" != \"Y\" ]; then\n        echo -e \"${YELLOW}âš  å·²å–æ¶ˆ${NC}\"\n        return 0\n    fi\n    \n    echo \"\"\n    echo -e \"${CYAN}æ­£åœ¨ç¦ç”¨æœ‰çº¿ç½‘ç»œ...${NC}\"\n    local eth_devices=($(nmcli -t -f DEVICE,TYPE device | grep ethernet | cut -d: -f1))\n    \n    for device in \"${eth_devices[@]}\"; do\n        nmcli device disconnect \"$device\" 2>/dev/null\n    done\n    \n    sleep 1\n    \n    echo -e \"${CYAN}æ­£åœ¨å¯ç”¨ WIFI...${NC}\"\n    nmcli radio wifi on\n    \n    sleep 2\n    \n    echo -e \"${GREEN}âœ“ å·²åˆ‡æ¢åˆ° WIFI æ¨¡å¼${NC}\"\n    echo \"\"\n    \n    # æ£€æŸ¥æ˜¯å¦æœ‰ä¿å­˜çš„ WIFI\n    if [ -s \"$CONFIG_FILE\" ]; then\n        echo -e \"${CYAN}æ˜¯å¦è¦è¿æ¥å·²ä¿å­˜çš„ WIFI? (y/n): ${NC}\"\n        read connect_choice\n        if [ \"$connect_choice\" = \"y\" ] || [ \"$connect_choice\" = \"Y\" ]; then\n            connect_saved_wifi\n            return\n        fi\n    fi\n    \n    # æ˜¾ç¤ºå½“å‰çŠ¶æ€\n    echo -e \"${CYAN}å½“å‰ç½‘ç»œçŠ¶æ€ï¼š${NC}\"\n    nmcli device | grep -E \"ethernet|wifi\"\n}\n\n# ç½‘ç»œåˆ‡æ¢èœå•\nswitch_menu() {\n    while true; do\n        clear\n        echo -e \"${BLUE}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}\"\n        echo -e \"${BLUE}â•‘           ç½‘ç»œåˆ‡æ¢èœå•                  â•‘${NC}\"\n        echo -e \"${BLUE}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}\"\n        echo \"\"\n        show_current_status\n        echo \"\"\n        echo -e \"${YELLOW}è¯·é€‰æ‹©æ“ä½œ:${NC}\"\n        echo -e \"  ${GREEN}1${NC}) åˆ‡æ¢åˆ°æœ‰çº¿ç½‘ç»œ (ç¦ç”¨WIFI)\"\n        echo -e \"  ${GREEN}2${NC}) åˆ‡æ¢åˆ° WIFI ç½‘ç»œ (ç¦ç”¨æœ‰çº¿)\"\n        echo -e \"  ${GREEN}0${NC}) è¿”å›ä¸»èœå•\"\n        echo \"\"\n        read -p \"è¯·è¾“å…¥é€‰é¡¹: \" choice\n        \n        case $choice in\n            1) switch_to_ethernet ;;\n            2) switch_to_wifi ;;\n            0) return 0 ;;\n            *) echo -e \"${RED}æ— æ•ˆçš„é€‰é¡¹${NC}\" ;;\n        esac\n        \n        read -p \"æŒ‰ Enter ç»§ç»­...\"\n    done\n}\n\n# ==================== ç»¼åˆçŠ¶æ€æŸ¥çœ‹ ====================\n\n# æ˜¾ç¤ºå®Œæ•´çš„ç½‘ç»œçŠ¶æ€\nshow_full_status() {\n    clear\n    echo -e \"${BLUE}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}\"\n    echo -e \"${BLUE}â•‘         ç»¼åˆç½‘ç»œçŠ¶æ€                    â•‘${NC}\"\n    echo -e \"${BLUE}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}\"\n    echo \"\"\n    \n    # æ‰€æœ‰ç½‘ç»œè®¾å¤‡\n    echo -e \"${CYAN}=== æ‰€æœ‰ç½‘ç»œè®¾å¤‡ ===${NC}\"\n    nmcli device\n    echo \"\"\n    \n    # æ´»åŠ¨è¿æ¥\n    echo -e \"${CYAN}=== æ´»åŠ¨è¿æ¥ ===${NC}\"\n    nmcli connection show --active\n    echo \"\"\n    \n    # WIFI çŠ¶æ€\n    echo -e \"${CYAN}=== WIFI çŠ¶æ€ ===${NC}\"\n    local wifi_status=$(nmcli radio wifi)\n    echo -e \"WIFI å¼€å…³: $wifi_status\"\n    \n    local current_wifi=$(nmcli -t -f active,ssid dev wifi | grep \"^yes\" | cut -d: -f2)\n    if [ -n \"$current_wifi\" ]; then\n        echo -e \"${GREEN}å½“å‰è¿æ¥: $current_wifi${NC}\"\n        local signal=$(nmcli -f IN-USE,SSID,SIGNAL dev wifi list | grep \"\\*\" | awk '{print $NF}')\n        echo -e \"ä¿¡å·å¼ºåº¦: $signal\"\n    else\n        echo -e \"${YELLOW}æœªè¿æ¥ WIFI${NC}\"\n    fi\n    echo \"\"\n    \n    # æœ‰çº¿ç½‘ç»œçŠ¶æ€\n    echo -e \"${CYAN}=== æœ‰çº¿ç½‘ç»œçŠ¶æ€ ===${NC}\"\n    nmcli device | grep ethernet\n    echo \"\"\n    \n    # è™šæ‹Ÿç½‘ç»œæ¥å£\n    echo -e \"${CYAN}=== è™šæ‹Ÿç½‘ç»œæ¥å£ ===${NC}\"\n    ip link show | grep -E \"docker|veth|br-|virbr\" | awk '{print \"  â€¢ \" $2}' | sed 's/:$//'\n    echo \"\"\n    \n    # IP åœ°å€\n    echo -e \"${CYAN}=== IP åœ°å€é…ç½® ===${NC}\"\n    ip -4 addr show | grep -E \"inet \" | grep -v \"127.0.0.1\" | awk '{print \"  IPv4: \" $2 \" (\" $(NF) \")\"}'\n    ip -6 addr show | grep -E \"inet6\" | grep -v \"::1\" | grep -v \"fe80\" | awk '{print \"  IPv6: \" $2 \" (\" $(NF) \")\"}'\n    echo \"\"\n    \n    # DNS é…ç½®\n    echo -e \"${CYAN}=== DNS é…ç½® ===${NC}\"\n    if [ -f /etc/resolv.conf ]; then\n        grep \"^nameserver\" /etc/resolv.conf | awk '{print \"  â€¢ \" $2}'\n    fi\n    echo \"\"\n    \n    # è·¯ç”±è¡¨\n    echo -e \"${CYAN}=== é»˜è®¤è·¯ç”± ===${NC}\"\n    ip route | grep default\n    echo \"\"\n    \n    # å…¬ç½‘ IP\n    echo -e \"${CYAN}=== å…¬ç½‘ IP ===${NC}\"\n    get_public_ip\n}\n\n# ==================== ä¸»èœå• ====================\n\n# æ˜¾ç¤ºä¸»èœå•\nshow_main_menu() {\n    clear\n    echo -e \"${BLUE}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}\"\n    echo -e \"${BLUE}â•‘          ç½‘ç»œç®¡ç†å·¥å…·                   â•‘${NC}\"\n    echo -e \"${BLUE}â•‘    WIFI å’Œæœ‰çº¿ç½‘ç»œå®Œæ•´ç®¡ç†              â•‘${NC}\"\n    echo -e \"${BLUE}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}\"\n    echo \"\"\n    show_current_status\n    echo \"\"\n    echo -e \"${YELLOW}è¯·é€‰æ‹©åŠŸèƒ½æ¨¡å—:${NC}\"\n    echo -e \"  ${GREEN}1${NC}) WIFI ç®¡ç†\"\n    echo -e \"  ${GREEN}2${NC}) æœ‰çº¿ç½‘ç»œç®¡ç†\"\n    echo -e \"  ${GREEN}3${NC}) ç½‘ç»œåˆ‡æ¢\"\n    echo -e \"  ${GREEN}4${NC}) ç»¼åˆçŠ¶æ€æŸ¥çœ‹\"\n    echo -e \"  ${GREEN}5${NC}) é€€å‡º\"\n    echo \"\"\n}\n\n# ä¸»ç¨‹åº\nmain() {\n    check_root\n    init_config\n    \n    while true; do\n        show_main_menu\n        read -p \"è¯·è¾“å…¥é€‰é¡¹ (1-5): \" choice\n        \n        case $choice in\n            1)\n                wifi_menu\n                ;;\n            2)\n                ethernet_menu\n                ;;\n            3)\n                switch_menu\n                ;;\n            4)\n                show_full_status\n                read -p \"æŒ‰ Enter è¿”å›ä¸»èœå•...\"\n                ;;\n            5)\n                echo -e \"${BLUE}æ„Ÿè°¢ä½¿ç”¨ç½‘ç»œç®¡ç†å·¥å…·ï¼${NC}\"\n                exit 0\n                ;;\n            *)\n                echo -e \"${RED}æ— æ•ˆçš„é€‰é¡¹ï¼Œè¯·é‡æ–°é€‰æ‹©${NC}\"\n                sleep 1\n                ;;\n        esac\n    done\n}\n\n# è¿è¡Œä¸»ç¨‹åº\nmain",
      "lines": 888,
      "added_time": "2025-12-14T02:33:55Z"
    },
    {
      "id": 14,
      "name": "x-server æ¡Œé¢æ˜¾ç¤ºä¿®å¤è„šæœ¬",
      "content": "#!/bin/bash\n\n# X Server ä¸€é”®ä¿®å¤è„šæœ¬\n# è§£å†³ \"Cannot run in framebuffer mode\" é”™è¯¯\n\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[1;33m'\nBLUE='\\033[0;34m'\nCYAN='\\033[0;36m'\nNC='\\033[0m'\n\necho -e \"${BLUE}========================================${NC}\"\necho -e \"${BLUE}  X Server ä¸€é”®ä¿®å¤å·¥å…·${NC}\"\necho -e \"${BLUE}========================================${NC}\"\necho \"\"\n\n# æ£€æŸ¥ root æƒé™\nif [ \"$EUID\" -ne 0 ]; then \n    echo -e \"${RED}âœ— éœ€è¦ root æƒé™${NC}\"\n    echo \"è¯·ä½¿ç”¨: sudo $0\"\n    exit 1\nfi\n\necho -e \"${CYAN}[1/6] åœæ­¢æ‰€æœ‰ X è¿›ç¨‹${NC}\"\npkill -9 X 2>/dev/null\npkill -9 xinit 2>/dev/null\nsleep 1\necho -e \"${GREEN}âœ“ å®Œæˆ${NC}\"\necho \"\"\n\necho -e \"${CYAN}[2/6] æ¸…ç†é”æ–‡ä»¶${NC}\"\nrm -f /tmp/.X0-lock\nrm -f /tmp/.X11-unix/X0\necho -e \"${GREEN}âœ“ å®Œæˆ${NC}\"\necho \"\"\n\necho -e \"${CYAN}[3/6] æ£€æµ‹æ˜¾ç¤ºè®¾å¤‡${NC}\"\nDRM_EXISTS=0\nFB_EXISTS=0\n\nif [ -e \"/dev/dri/card0\" ]; then\n    echo -e \"${GREEN}âœ“ æ£€æµ‹åˆ° DRM è®¾å¤‡: /dev/dri/card0${NC}\"\n    DRM_EXISTS=1\nfi\n\nif [ -e \"/dev/fb0\" ]; then\n    echo -e \"${GREEN}âœ“ æ£€æµ‹åˆ° Framebuffer: /dev/fb0${NC}\"\n    FB_NAME=$(cat /sys/class/graphics/fb0/name 2>/dev/null)\n    echo \"  é©±åŠ¨åç§°: $FB_NAME\"\n    FB_EXISTS=1\nfi\n\nif [ $DRM_EXISTS -eq 0 ] && [ $FB_EXISTS -eq 0 ]; then\n    echo -e \"${RED}âœ— é”™è¯¯ï¼šæ²¡æœ‰æ£€æµ‹åˆ°ä»»ä½•æ˜¾ç¤ºè®¾å¤‡ï¼${NC}\"\n    echo \"\"\n    echo \"å¯èƒ½åŸå› ï¼š\"\n    echo \"  1. æ˜¾å¡é©±åŠ¨æœªå®‰è£…\"\n    echo \"  2. HDMI æœªè¿æ¥\"\n    echo \"  3. ç¡¬ä»¶ä¸æ”¯æŒ\"\n    exit 1\nfi\necho \"\"\n\necho -e \"${CYAN}[4/6] å®‰è£…å¿…è¦é©±åŠ¨${NC}\"\napt-get install -y \\\n    xserver-xorg-video-modesetting \\\n    xserver-xorg-video-fbdev \\\n    xserver-xorg-video-fbturbo \\\n    -qq 2>/dev/null\n\nif [ $? -eq 0 ]; then\n    echo -e \"${GREEN}âœ“ é©±åŠ¨å®‰è£…/æ›´æ–°å®Œæˆ${NC}\"\nelse\n    echo -e \"${YELLOW}âš  é©±åŠ¨å¯èƒ½å·²å®‰è£…${NC}\"\nfi\necho \"\"\n\necho -e \"${CYAN}[5/6] åˆ›å»ºé…ç½®æ–‡ä»¶${NC}\"\n\n# åˆ›å»ºé…ç½®ç›®å½•\nmkdir -p /etc/X11/xorg.conf.d\n\n# æ¸…ç†æ—§é…ç½®\nrm -f /etc/X11/xorg.conf.d/20-*.conf 2>/dev/null\nrm -f /etc/X11/xorg.conf.d/99-*.conf 2>/dev/null\n\nCONFIG_TYPE=\"\"\n\nif [ $DRM_EXISTS -eq 1 ]; then\n    # ä½¿ç”¨ DRM æ¨¡å¼ï¼ˆæ¨èï¼‰\n    echo \"åˆ›å»º DRM é…ç½®...\"\n    cat > /etc/X11/xorg.conf.d/20-graphics.conf << 'EOF'\nSection \"Device\"\n    Identifier \"Primary\"\n    Driver \"modesetting\"\n    Option \"kmsdev\" \"/dev/dri/card0\"\n    Option \"SWcursor\" \"true\"\n    Option \"AccelMethod\" \"none\"\nEndSection\n\nSection \"Screen\"\n    Identifier \"Screen0\"\n    Device \"Primary\"\nEndSection\nEOF\n    CONFIG_TYPE=\"DRM (modesetting)\"\n    \nelif [ $FB_EXISTS -eq 1 ]; then\n    # ä½¿ç”¨ Framebuffer æ¨¡å¼\n    echo \"åˆ›å»º Framebuffer é…ç½®...\"\n    cat > /etc/X11/xorg.conf.d/20-graphics.conf << 'EOF'\nSection \"Device\"\n    Identifier \"Primary\"\n    Driver \"fbdev\"\n    Option \"fbdev\" \"/dev/fb0\"\n    Option \"ShadowFB\" \"false\"\nEndSection\n\nSection \"Screen\"\n    Identifier \"Screen0\"\n    Device \"Primary\"\nEndSection\nEOF\n    CONFIG_TYPE=\"Framebuffer (fbdev)\"\nfi\n\n# è®¾ç½®æ­£ç¡®æƒé™\nchmod 644 /etc/X11/xorg.conf.d/20-graphics.conf\n\necho -e \"${GREEN}âœ“ é…ç½®æ–‡ä»¶å·²åˆ›å»º${NC}\"\necho \"  ç±»å‹: $CONFIG_TYPE\"\necho \"  ä½ç½®: /etc/X11/xorg.conf.d/20-graphics.conf\"\necho \"\"\n\necho -e \"${CYAN}é…ç½®æ–‡ä»¶å†…å®¹ï¼š${NC}\"\necho \"----------------------------------------\"\ncat /etc/X11/xorg.conf.d/20-graphics.conf\necho \"----------------------------------------\"\necho \"\"\n\necho -e \"${CYAN}[6/6] éªŒè¯é…ç½®${NC}\"\n\n# éªŒè¯é…ç½®æ–‡ä»¶\nif [ -f /etc/X11/xorg.conf.d/20-graphics.conf ]; then\n    FILE_SIZE=$(stat -c%s /etc/X11/xorg.conf.d/20-graphics.conf)\n    if [ $FILE_SIZE -gt 50 ]; then\n        echo -e \"${GREEN}âœ“ é…ç½®æ–‡ä»¶éªŒè¯é€šè¿‡ (å¤§å°: $FILE_SIZE å­—èŠ‚)${NC}\"\n    else\n        echo -e \"${RED}âœ— é…ç½®æ–‡ä»¶å¼‚å¸¸ (å¤§å°è¿‡å°)${NC}\"\n        exit 1\n    fi\nelse\n    echo -e \"${RED}âœ— é…ç½®æ–‡ä»¶åˆ›å»ºå¤±è´¥${NC}\"\n    exit 1\nfi\necho \"\"\n\necho -e \"${BLUE}========================================${NC}\"\necho -e \"${BLUE}  ä¿®å¤å®Œæˆï¼${NC}\"\necho -e \"${BLUE}========================================${NC}\"\necho \"\"\n\necho -e \"${YELLOW}ç¡¬ä»¶çŠ¶æ€ï¼š${NC}\"\n[ $DRM_EXISTS -eq 1 ] && echo -e \"  ${GREEN}âœ“${NC} DRM è®¾å¤‡å¯ç”¨\"\n[ $FB_EXISTS -eq 1 ] && echo -e \"  ${GREEN}âœ“${NC} Framebuffer å¯ç”¨\"\necho \"\"\n\necho -e \"${YELLOW}é…ç½®çŠ¶æ€ï¼š${NC}\"\necho \"  é©±åŠ¨ç±»å‹: $CONFIG_TYPE\"\necho \"  é…ç½®æ–‡ä»¶: /etc/X11/xorg.conf.d/20-graphics.conf\"\necho \"\"\n\necho -e \"${YELLOW}ä¸‹ä¸€æ­¥æ“ä½œï¼š${NC}\"\necho \"\"\necho -e \"${GREEN}æ–¹æ³• 1: ç›´æ¥å¯åŠ¨å›¾å½¢ç•Œé¢ï¼ˆæµ‹è¯•ï¼‰${NC}\"\necho \"  startx\"\necho \"\"\necho -e \"${GREEN}æ–¹æ³• 2: ä½¿ç”¨å¿«æ·å‘½ä»¤${NC}\"\necho \"  start-gui\"\necho \"\"\necho -e \"${GREEN}æ–¹æ³• 3: è®¾ç½®å¼€æœºè‡ªåŠ¨å¯åŠ¨å›¾å½¢ç•Œé¢${NC}\"\necho \"  sudo systemctl set-default graphical.target\"\necho \"  sudo reboot\"\necho \"\"\n\necho -e \"${CYAN}æ—¥å¿—ä½ç½®ï¼š${NC}\"\necho \"  X Server æ—¥å¿—: /var/log/Xorg.0.log\"\necho \"  æŸ¥çœ‹é”™è¯¯: grep EE /var/log/Xorg.0.log\"\necho \"\"\n\nread -p \"æ˜¯å¦ç«‹å³å¯åŠ¨å›¾å½¢ç•Œé¢æµ‹è¯•? (y/n): \" test_start\n\nif [ \"$test_start\" = \"y\" ] || [ \"$test_start\" = \"Y\" ]; then\n    echo \"\"\n    echo -e \"${GREEN}æ­£åœ¨å¯åŠ¨å›¾å½¢ç•Œé¢...${NC}\"\n    echo -e \"${YELLOW}(å¦‚æœé»‘å±è¶…è¿‡ 30 ç§’ï¼ŒæŒ‰ Ctrl+Alt+F2 è¿”å›ç»ˆç«¯)${NC}\"\n    echo \"\"\n    sleep 2\n    startx\nelse\n    echo \"\"\n    echo -e \"${GREEN}ä¿®å¤å®Œæˆï¼${NC}\"\n    echo \"å‡†å¤‡å¥½åè¿è¡Œ: ${CYAN}startx${NC}\"\n    echo \"\"\nfi",
      "lines": 205,
      "added_time": "2025-12-14T05:40:20Z"
    },
    {
      "id": 15,
      "name": "Xserver XDRP æ¡Œé¢å®‰è£…è„šæœ¬",
      "content": "#!/bin/bash\n\n# XFCE4 + xrdp æ™ºèƒ½å®‰è£…è„šæœ¬\n# åŠŸèƒ½: \n# - å®‰è£… XFCE4 æ¡Œé¢ç¯å¢ƒ\n# - é…ç½® xrdp è¿œç¨‹æ¡Œé¢\n# - æ™ºèƒ½ HDMI æ£€æµ‹(æœ‰æ˜¾ç¤ºå™¨æ‰å¯åŠ¨å›¾å½¢ç•Œé¢)\n# - æ‘„åƒå¤´è°ƒè¯•å·¥å…·\n\n# é¢œè‰²å®šä¹‰\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[1;33m'\nBLUE='\\033[0;34m'\nCYAN='\\033[0;36m'\nNC='\\033[0m'\n\n# æ—¥å¿—æ–‡ä»¶\nLOG_FILE=\"/var/log/xfce_xrdp_install.log\"\n\n# æ‰“å°å‡½æ•°\nprint_header() {\n    echo -e \"${BLUE}================================================${NC}\"\n    echo -e \"${BLUE}  $1${NC}\"\n    echo -e \"${BLUE}================================================${NC}\"\n}\n\nprint_step() {\n    echo -e \"${CYAN}[æ­¥éª¤] $1${NC}\"\n    echo \"[$(date '+%Y-%m-%d %H:%M:%S')] $1\" >> \"$LOG_FILE\"\n}\n\nprint_success() {\n    echo -e \"${GREEN}âœ“ $1${NC}\"\n    echo \"[$(date '+%Y-%m-%d %H:%M:%S')] SUCCESS: $1\" >> \"$LOG_FILE\"\n}\n\nprint_error() {\n    echo -e \"${RED}âœ— $1${NC}\"\n    echo \"[$(date '+%Y-%m-%d %H:%M:%S')] ERROR: $1\" >> \"$LOG_FILE\"\n}\n\nprint_warning() {\n    echo -e \"${YELLOW}âš  $1${NC}\"\n    echo \"[$(date '+%Y-%m-%d %H:%M:%S')] WARNING: $1\" >> \"$LOG_FILE\"\n}\n\n# æ£€æŸ¥ root æƒé™\ncheck_root() {\n    if [ \"$EUID\" -ne 0 ]; then \n        print_error \"è¯·ä½¿ç”¨ root æƒé™è¿è¡Œæ­¤è„šæœ¬\"\n        echo \"ä½¿ç”¨æ–¹æ³•: sudo $0\"\n        exit 1\n    fi\n}\n\n# æ£€æŸ¥ç½‘ç»œè¿æ¥\ncheck_network() {\n    print_step \"æ£€æŸ¥ç½‘ç»œè¿æ¥...\"\n    if ping -c 1 8.8.8.8 &> /dev/null; then\n        print_success \"ç½‘ç»œè¿æ¥æ­£å¸¸\"\n        return 0\n    else\n        print_error \"ç½‘ç»œè¿æ¥å¤±è´¥,è¯·æ£€æŸ¥ç½‘ç»œè®¾ç½®\"\n        exit 1\n    fi\n}\n\n# æ›´æ–°ç³»ç»Ÿ\nupdate_system() {\n    print_step \"æ›´æ–°è½¯ä»¶æº...\"\n    apt-get update >> \"$LOG_FILE\" 2>&1\n    if [ $? -eq 0 ]; then\n        print_success \"è½¯ä»¶æºæ›´æ–°å®Œæˆ\"\n    else\n        print_warning \"è½¯ä»¶æºæ›´æ–°é‡åˆ°é—®é¢˜,ç»§ç»­å®‰è£…...\"\n    fi\n}\n\n# å®‰è£… X Server\ninstall_xserver() {\n    print_step \"å®‰è£… X Server...\"\n    \n    apt-get install -y \\\n        xserver-xorg \\\n        xserver-xorg-core \\\n        xserver-xorg-input-all \\\n        xserver-xorg-video-fbdev \\\n        x11-xserver-utils \\\n        xinit \\\n        >> \"$LOG_FILE\" 2>&1\n    \n    if [ $? -eq 0 ]; then\n        print_success \"X Server å®‰è£…å®Œæˆ\"\n    else\n        print_error \"X Server å®‰è£…å¤±è´¥\"\n        exit 1\n    fi\n}\n\n# å®‰è£… XFCE4 æ¡Œé¢ç¯å¢ƒ\ninstall_xfce4() {\n    print_step \"å®‰è£… XFCE4 æ¡Œé¢ç¯å¢ƒ...\"\n    echo \"è¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´,è¯·è€å¿ƒç­‰å¾…...\"\n    \n    apt-get install -y \\\n        xfce4 \\\n        xfce4-goodies \\\n        xfce4-terminal \\\n        >> \"$LOG_FILE\" 2>&1\n    \n    if [ $? -eq 0 ]; then\n        print_success \"XFCE4 å®‰è£…å®Œæˆ\"\n    else\n        print_error \"XFCE4 å®‰è£…å¤±è´¥\"\n        exit 1\n    fi\n}\n\n# å®‰è£… xrdp\ninstall_xrdp() {\n    print_step \"å®‰è£… xrdp è¿œç¨‹æ¡Œé¢...\"\n    \n    apt-get install -y \\\n        xrdp \\\n        >> \"$LOG_FILE\" 2>&1\n    \n    if [ $? -eq 0 ]; then\n        print_success \"xrdp å®‰è£…å®Œæˆ\"\n    else\n        print_error \"xrdp å®‰è£…å¤±è´¥\"\n        exit 1\n    fi\n}\n\n# é…ç½® xrdp\nconfigure_xrdp() {\n    print_step \"é…ç½® xrdp...\"\n    \n    # å¤‡ä»½åŸå§‹é…ç½®\n    if [ -f /etc/xrdp/xrdp.ini ]; then\n        cp /etc/xrdp/xrdp.ini /etc/xrdp/xrdp.ini.backup\n    fi\n    \n    # é…ç½® xrdp.ini - ä¼˜åŒ–æ€§èƒ½\n    cat > /etc/xrdp/xrdp.ini << 'EOF'\n[Globals]\nini_version=1\nfork=true\nport=3389\ntcp_nodelay=true\ntcp_keepalive=true\nsecurity_layer=negotiate\ncrypt_level=high\ncertificate=\nkey_file=\nssl_protocols=TLSv1.2, TLSv1.3\nautorun=\nallow_channels=true\nallow_multimon=true\nbitmap_cache=true\nbitmap_compression=true\nbulk_compression=true\nmax_bpp=32\nnew_cursors=true\nuse_fastpath=both\n\n[Xorg]\nname=Xorg\nlib=libxup.so\nusername=ask\npassword=ask\nip=127.0.0.1\nport=-1\ncode=20\nEOF\n\n    # é…ç½®å¯åŠ¨è„šæœ¬ - ä½¿ç”¨ XFCE4\n    cat > /etc/xrdp/startwm.sh << 'EOF'\n#!/bin/sh\n# xrdp X session start script\n\nif [ -r /etc/default/locale ]; then\n  . /etc/default/locale\n  export LANG LANGUAGE\nfi\n\n# å¯åŠ¨ XFCE4\nstartxfce4\nEOF\n\n    chmod +x /etc/xrdp/startwm.sh\n    \n    # æ·»åŠ  xrdp ç”¨æˆ·åˆ° ssl-cert ç»„\n    adduser xrdp ssl-cert 2>/dev/null\n    \n    print_success \"xrdp é…ç½®å®Œæˆ\"\n}\n\n# å®‰è£…æ‘„åƒå¤´è°ƒè¯•å·¥å…·\ninstall_camera_tools() {\n    print_step \"å®‰è£…æ‘„åƒå¤´è°ƒè¯•å·¥å…·...\"\n    \n    apt-get install -y \\\n        cheese \\\n        guvcview \\\n        v4l-utils \\\n        ffmpeg \\\n        >> \"$LOG_FILE\" 2>&1\n    \n    if [ $? -eq 0 ]; then\n        print_success \"æ‘„åƒå¤´å·¥å…·å®‰è£…å®Œæˆ\"\n        echo \"\"\n        echo -e \"${CYAN}æ‘„åƒå¤´å·¥å…·è¯´æ˜:${NC}\"\n        echo \"  - cheese: ç®€å•çš„æ‘„åƒå¤´æŸ¥çœ‹å™¨\"\n        echo \"  - guvcview: é«˜çº§æ‘„åƒå¤´å·¥å…·(å¯è°ƒå‚æ•°)\"\n        echo \"  - v4l2-ctl: å‘½ä»¤è¡Œå·¥å…·,æŸ¥çœ‹æ‘„åƒå¤´ä¿¡æ¯\"\n        echo \"  - ffmpeg: è§†é¢‘æ•è·å’Œæµ‹è¯•\"\n        echo \"\"\n    else\n        print_warning \"æ‘„åƒå¤´å·¥å…·å®‰è£…å¤±è´¥(ä¸å½±å“ä¸»è¦åŠŸèƒ½)\"\n    fi\n}\n\n# åˆ›å»º HDMI æ£€æµ‹è„šæœ¬\ncreate_hdmi_detection() {\n    print_step \"åˆ›å»º HDMI æ™ºèƒ½æ£€æµ‹æœåŠ¡...\"\n    \n    # HDMI æ£€æµ‹è„šæœ¬\n    cat > /usr/local/bin/hdmi-detect.sh << 'EOF'\n#!/bin/bash\n\n# HDMI æ£€æµ‹è„šæœ¬\nLOG_FILE=\"/var/log/hdmi-detect.log\"\n\nlog_message() {\n    echo \"[$(date '+%Y-%m-%d %H:%M:%S')] $1\" >> \"$LOG_FILE\"\n}\n\n# æ£€æµ‹ HDMI è¿æ¥çŠ¶æ€\ncheck_hdmi() {\n    # æ–¹æ³•1: æ£€æŸ¥ /sys/class/drm\n    if [ -d \"/sys/class/drm\" ]; then\n        for card in /sys/class/drm/card*/status; do\n            if [ -f \"$card\" ]; then\n                status=$(cat \"$card\" 2>/dev/null)\n                if [ \"$status\" = \"connected\" ]; then\n                    log_message \"æ£€æµ‹åˆ° HDMI è¿æ¥: $card\"\n                    return 0\n                fi\n            fi\n        done\n    fi\n    \n    # æ–¹æ³•2: ä½¿ç”¨ xrandr (å¦‚æœ X å·²è¿è¡Œ)\n    if command -v xrandr &> /dev/null; then\n        if xrandr 2>/dev/null | grep -q \" connected\"; then\n            log_message \"xrandr æ£€æµ‹åˆ°æ˜¾ç¤ºå™¨è¿æ¥\"\n            return 0\n        fi\n    fi\n    \n    log_message \"æœªæ£€æµ‹åˆ° HDMI è¿æ¥\"\n    return 1\n}\n\n# å¯åŠ¨å›¾å½¢ç•Œé¢\nstart_graphical() {\n    log_message \"å¯åŠ¨å›¾å½¢ç•Œé¢...\"\n    systemctl isolate graphical.target\n}\n\n# ä¸»é€»è¾‘\nlog_message \"å¼€å§‹ HDMI æ£€æµ‹\"\n\nif check_hdmi; then\n    log_message \"HDMI å·²è¿æ¥,å‡†å¤‡å¯åŠ¨å›¾å½¢ç•Œé¢\"\n    start_graphical\nelse\n    log_message \"HDMI æœªè¿æ¥,ä¿æŒå‘½ä»¤è¡Œæ¨¡å¼\"\n    systemctl isolate multi-user.target\nfi\nEOF\n\n    chmod +x /usr/local/bin/hdmi-detect.sh\n    \n    # åˆ›å»º systemd æœåŠ¡\n    cat > /etc/systemd/system/hdmi-detect.service << 'EOF'\n[Unit]\nDescription=HDMI Detection and Auto Start X\nAfter=multi-user.target\nBefore=graphical.target\n\n[Service]\nType=oneshot\nExecStart=/usr/local/bin/hdmi-detect.sh\nRemainAfterExit=yes\n\n[Install]\nWantedBy=multi-user.target\nEOF\n\n    # å¯ç”¨æœåŠ¡\n    systemctl daemon-reload\n    systemctl enable hdmi-detect.service >> \"$LOG_FILE\" 2>&1\n    \n    print_success \"HDMI æ™ºèƒ½æ£€æµ‹æœåŠ¡åˆ›å»ºå®Œæˆ\"\n}\n\n# åˆ›å»ºæ‰‹åŠ¨æ§åˆ¶è„šæœ¬\ncreate_control_scripts() {\n    print_step \"åˆ›å»ºæ‰‹åŠ¨æ§åˆ¶è„šæœ¬...\"\n    \n    # å¯åŠ¨å›¾å½¢ç•Œé¢è„šæœ¬\n    cat > /usr/local/bin/start-gui << 'EOF'\n#!/bin/bash\necho \"æ­£åœ¨å¯åŠ¨å›¾å½¢ç•Œé¢...\"\nif [ \"$DISPLAY\" = \"\" ]; then\n    startx\nelse\n    echo \"å›¾å½¢ç•Œé¢å·²åœ¨è¿è¡Œ\"\nfi\nEOF\n    chmod +x /usr/local/bin/start-gui\n    \n    # åœæ­¢å›¾å½¢ç•Œé¢è„šæœ¬\n    cat > /usr/local/bin/stop-gui << 'EOF'\n#!/bin/bash\necho \"æ­£åœ¨åœæ­¢å›¾å½¢ç•Œé¢...\"\nsystemctl isolate multi-user.target\npkill -u $USER X\nEOF\n    chmod +x /usr/local/bin/stop-gui\n    \n    print_success \"æ§åˆ¶è„šæœ¬åˆ›å»ºå®Œæˆ\"\n    echo \"  - start-gui: æ‰‹åŠ¨å¯åŠ¨å›¾å½¢ç•Œé¢\"\n    echo \"  - stop-gui: åœæ­¢å›¾å½¢ç•Œé¢\"\n}\n\n# é…ç½®é˜²ç«å¢™(å¦‚æœå­˜åœ¨)\nconfigure_firewall() {\n    print_step \"é…ç½®é˜²ç«å¢™è§„         ...\"\n    \n    if command -v ufw &> /dev/null; then\n        ufw allow 3389/tcp >> \"$LOG_FILE\" 2>&1\n        print_success \"UFW é˜²ç«å¢™å·²å¼€æ”¾ 3389 ç«¯å£\"\n    elif command -v firewall-cmd &> /dev/null; then\n        firewall-cmd --permanent --add-port=3389/tcp >> \"$LOG_FILE\" 2>&1\n        firewall-cmd --reload >> \"$LOG_FILE\" 2>&1\n        print_success \"firewalld é˜²ç«å¢™å·²å¼€æ”¾ 3389 ç«¯å£\"\n    else\n        print_warning \"æœªæ£€æµ‹åˆ°é˜²ç«å¢™,è·³è¿‡é…ç½®\"\n    fi\n}\n\n# å¯åŠ¨æœåŠ¡\nstart_services() {\n    print_step \"å¯åŠ¨ xrdp æœåŠ¡...\"\n    \n    systemctl enable xrdp >> \"$LOG_FILE\" 2>&1\n    systemctl start xrdp >> \"$LOG_FILE\" 2>&1\n    \n    if systemctl is-active --quiet xrdp; then\n        print_success \"xrdp æœåŠ¡å¯åŠ¨æˆåŠŸ\"\n    else\n        print_error \"xrdp æœåŠ¡å¯åŠ¨å¤±è´¥\"\n        echo \"è¯·æŸ¥çœ‹æ—¥å¿—: journalctl -u xrdp\"\n        exit 1\n    fi\n}\n\n# è®¾ç½®é»˜è®¤å¯åŠ¨æ¨¡å¼\nset_default_target() {\n    print_step \"é…ç½®å¯åŠ¨æ¨¡å¼...\"\n    \n    # è®¾ç½®é»˜è®¤ä¸º multi-user (å‘½ä»¤è¡Œ)\n    # HDMI æ£€æµ‹æœåŠ¡ä¼šæ ¹æ®å®é™…æƒ…å†µåˆ‡æ¢\n    systemctl set-default multi-user.target >> \"$LOG_FILE\" 2>&1\n    \n    print_success \"é»˜è®¤å¯åŠ¨æ¨¡å¼: å‘½ä»¤è¡Œ (æ™ºèƒ½æ£€æµ‹ HDMI)\"\n}\n\n# åˆ›å»ºç”¨æˆ·é…ç½®\nsetup_user_config() {\n    print_step \"é…ç½®ç”¨æˆ·ç¯å¢ƒ...\"\n    \n    # è·å–æ‰€æœ‰æ™®é€šç”¨æˆ·\n    for user_home in /home/*; do\n        if [ -d \"$user_home\" ]; then\n            username=$(basename \"$user_home\")\n            \n            # åˆ›å»º .xsession æ–‡ä»¶\n            cat > \"$user_home/.xsession\" << 'EOF'\n#!/bin/sh\nstartxfce4\nEOF\n            chown $username:$username \"$user_home/.xsession\"\n            chmod +x \"$user_home/.xsession\"\n        fi\n    done\n    \n    print_success \"ç”¨æˆ·ç¯å¢ƒé…ç½®å®Œæˆ\"\n}\n\n# ç³»ç»Ÿæµ‹è¯•\nsystem_test() {\n    print_step \"æ‰§è¡Œç³»ç»Ÿæµ‹è¯•...\"\n    \n    echo \"\"\n    echo -e \"${YELLOW}=== æœåŠ¡çŠ¶æ€ ===${NC}\"\n    \n    # æµ‹è¯• xrdp\n    if systemctl is-active --quiet xrdp; then\n        print_success \"xrdp æœåŠ¡è¿è¡Œä¸­\"\n    else\n        print_error \"xrdp æœåŠ¡æœªè¿è¡Œ\"\n    fi\n    \n    # æµ‹è¯•ç«¯å£\n    if netstat -tuln 2>/dev/null | grep -q \":3389\"; then\n        print_success \"xrdp ç«¯å£ 3389 å·²ç›‘å¬\"\n    else\n        print_warning \"ç«¯å£ 3389 æœªç›‘å¬\"\n    fi\n    \n    # HDMI æ£€æµ‹\n    echo \"\"\n    echo -e \"${YELLOW}=== HDMI çŠ¶æ€ ===${NC}\"\n    if [ -d \"/sys/class/drm\" ]; then\n        for card in /sys/class/drm/card*/status; do\n            if [ -f \"$card\" ]; then\n                status=$(cat \"$card\" 2>/dev/null)\n                if [ \"$status\" = \"connected\" ]; then\n                    print_success \"æ£€æµ‹åˆ° HDMI è¿æ¥\"\n                else\n                    echo -e \"${CYAN}HDMI çŠ¶æ€: $status${NC}\"\n                fi\n            fi\n        done\n    fi\n    \n    echo \"\"\n}\n\n# æ˜¾ç¤ºå®Œæˆä¿¡æ¯\nshow_completion_info() {\n    clear\n    print_header \"å®‰è£…å®Œæˆ!\"\n    \n    echo \"\"\n    echo -e \"${GREEN}âœ“ XFCE4 æ¡Œé¢ç¯å¢ƒå·²å®‰è£…${NC}\"\n    echo -e \"${GREEN}âœ“ xrdp è¿œç¨‹æ¡Œé¢å·²é…ç½®${NC}\"\n    echo -e \"${GREEN}âœ“ HDMI æ™ºèƒ½æ£€æµ‹å·²å¯ç”¨${NC}\"\n    echo -e \"${GREEN}âœ“ æ‘„åƒå¤´è°ƒè¯•å·¥å…·å·²å®‰è£…${NC}\"\n    echo \"\"\n    \n    echo -e \"${CYAN}=== ä½¿ç”¨è¯´æ˜ ===${NC}\"\n    echo \"\"\n    \n    echo -e \"${YELLOW}1. è¿œç¨‹æ¡Œé¢è¿æ¥:${NC}\"\n    echo \"   - ä½¿ç”¨ RDP å®¢æˆ·ç«¯è¿æ¥åˆ°: $(hostname -I | awk '{print $1}'):3389\"\n    echo \"   - Windows: ä½¿ç”¨ 'è¿œç¨‹æ¡Œé¢è¿æ¥'\"\n    echo \"   - Mac: ä½¿ç”¨ 'Microsoft Remote Desktop'\"\n    echo \"   - Linux: ä½¿ç”¨ 'rdesktop' æˆ– 'Remmina'\"\n    echo \"\"\n    \n    echo -e \"${YELLOW}2. HDMI æ˜¾ç¤º:${NC}\"\n    echo \"   - è¿æ¥ HDMI: è‡ªåŠ¨å¯åŠ¨å›¾å½¢ç•Œé¢\"\n    echo \"   - æ–­å¼€ HDMI: ä¿æŒå‘½ä»¤è¡Œæ¨¡å¼\"\n    echo \"   - æ‰‹åŠ¨å¯åŠ¨å›¾å½¢ç•Œé¢: start-gui\"\n    echo \"   - åœæ­¢å›¾å½¢ç•Œé¢: stop-gui\"\n    echo \"\"\n    \n    echo -e \"${YELLOW}3. æ‘„åƒå¤´è°ƒè¯•:${NC}\"\n    echo \"   - å›¾å½¢ç•Œé¢å·¥å…·: cheese æˆ– guvcview\"\n    echo \"   - å‘½ä»¤è¡ŒæŸ¥çœ‹è®¾å¤‡: v4l2-ctl --list-devices\"\n    echo \"   - æµ‹è¯•æ‘„åƒå¤´: v4l2-ctl -d /dev/video0 --list-formats-ext\"\n    echo \"   - å½•åˆ¶è§†é¢‘: ffmpeg -i /dev/video0 output.mp4\"\n    echo \"\"\n    \n    echo -e \"${YELLOW}4. æ—¥å¿—ä½ç½®:${NC}\"\n    echo \"   - å®‰è£…æ—¥å¿—: $LOG_FILE\"\n    echo \"   - HDMI æ£€æµ‹æ—¥å¿—: /var/log/hdmi-detect.log\"\n    echo \"   - xrdp æ—¥å¿—: /var/log/xrdp.log\"\n    echo \"\"\n    \n    echo -e \"${YELLOW}5. é‡è¦æç¤º:${NC}\"\n    echo \"   - é¦–æ¬¡è¿œç¨‹è¿æ¥éœ€è¦è¾“å…¥ç”¨æˆ·åå’Œå¯†ç \"\n    echo \"   - å»ºè®®é‡å¯ç³»ç»Ÿä»¥å®Œå…¨åº”ç”¨æ‰€æœ‰é…ç½®: reboot\"\n    echo \"   - xrdp ä¼šä¸ºæ¯ä¸ªç”¨æˆ·åˆ›å»ºç‹¬ç«‹çš„æ¡Œé¢ä¼šè¯\"\n    echo \"\"\n    \n    echo -e \"${RED}æ˜¯å¦ç°åœ¨é‡å¯ç³»ç»Ÿ? (y/n)${NC}\"\n    read -p \"è¾“å…¥é€‰æ‹©: \" reboot_choice\n    \n    if [ \"$reboot_choice\" = \"y\" ] || [ \"$reboot_choice\" = \"Y\" ]; then\n        echo \"ç³»ç»Ÿå°†åœ¨ 5 ç§’åé‡å¯...\"\n        sleep 5\n        reboot\n    else\n        echo -e \"${GREEN}å®‰è£…å®Œæˆ!è®°å¾—ç¨åé‡å¯ç³»ç»Ÿã€‚${NC}\"\n    fi\n}\n\n# ä¸»å‡½æ•°\nmain() {\n    clear\n    print_header \"XFCE4 + xrdp æ™ºèƒ½å®‰è£…ç¨‹åº\"\n    \n    echo \"\"\n    echo \"æ­¤è„šæœ¬å°†å®‰è£…:\"\n    echo \"  âœ“ XFCE4 æ¡Œé¢ç¯å¢ƒ\"\n    echo \"  âœ“ xrdp è¿œç¨‹æ¡Œé¢æœåŠ¡\"\n    echo \"  âœ“ X Server å›¾å½¢æœåŠ¡å™¨\"\n    echo \"  âœ“ HDMI æ™ºèƒ½æ£€æµ‹(è‡ªåŠ¨åˆ¤æ–­æ˜¯å¦å¯åŠ¨å›¾å½¢ç•Œé¢)\"\n    echo \"  âœ“ æ‘„åƒå¤´è°ƒè¯•å·¥å…·(cheese, guvcview, v4l-utils, ffmpeg)\"\n    echo \"\"\n    echo -e \"${YELLOW}é¢„è®¡å®‰è£…æ—¶é—´: 5-10 åˆ†é’Ÿ${NC}\"\n    echo \"\"\n    read -p \"æŒ‰å›è½¦é”®å¼€å§‹å®‰è£…,æˆ– Ctrl+C å–æ¶ˆ...\"\n    \n    echo \"\"\n    echo \"å¼€å§‹å®‰è£…...\" | tee \"$LOG_FILE\"\n    echo \"\"\n    \n    # æ‰§è¡Œå®‰è£…æ­¥éª¤\n    check_root\n    check_network\n    update_system\n    install_xserver\n    install_xfce4\n    install_xrdp\n    configure_xrdp\n    install_camera_tools\n    create_hdmi_detection\n    create_control_scripts\n    configure_firewall\n    setup_user_config\n    set_default_target\n    start_services\n    system_test\n    \n    # æ˜¾ç¤ºå®Œæˆä¿¡æ¯\n    show_completion_info\n}\n\n# è¿è¡Œä¸»ç¨‹åº\nmain",
      "lines": 547,
      "added_time": "2025-12-14T05:42:59Z"
    }
  ]
}
